(this.webpackJsonppytest_commander=this.webpackJsonppytest_commander||[]).push([[0],{142:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n.n(a),c=n(70),s=n.n(c),r=n(77),o=n(71),i=n(39),d=n(72),u=n(23),h=n(40),m=n(45),g=n(73),v=n.n(g),f=n(74),E=n.n(f),p=n(17),b=n(18),T=n(3),j="#F3F3F3",y="#D0D0D0",k="25em",L=n(41),O=n.n(L),R=n(143),w=n(144),x=n(9),I=n(10),B=function(e){return O.a.isEmpty(e.childBranches)&&O.a.isEmpty(e.childLeaves)?l.a.createElement("div",{className:Object(T.b)(U.navColumn)}):l.a.createElement("div",{className:Object(T.b)(U.navColumn)},l.a.createElement(R.a,null,l.a.createElement(D,{childBranches:e.childBranches,childLeaves:e.childLeaves,selection:e.selection,selectedLeafID:e.selectedLeafID,handleTestRun:e.handleTestRun,handleEnvToggle:e.handleEnvToggle})))},D=function(e){var t=Object.keys(e.childBranches).map((function(e){return{shortID:e,branch:!0}})).concat(Object.keys(e.childLeaves).map((function(e){return{shortID:e,branch:!1}}))).sort((function(e,t){return e.shortID.localeCompare(t.shortID)}));return l.a.createElement(l.a.Fragment,null,t.map((function(t){if(t.branch){var n=e.childBranches[t.shortID];return l.a.createElement(N,{node:n,selection:e.selection,handleTestRun:e.handleTestRun,handleEnvToggle:e.handleEnvToggle})}var a=e.childLeaves[t.shortID];return l.a.createElement(P,{node:a,selectedLeafID:e.selectedLeafID,handleTestRun:e.handleTestRun})})))},N=function(e){var t="/"+e.selection.concat([e.node.short_id]).map(encodeURIComponent).join("/");return l.a.createElement(w.a,{key:e.node.short_id,className:Object(T.b)(z(e.node.status),U.navEntryCommon)},l.a.createElement("span",{className:Object(T.b)(U.navLabel)},l.a.createElement(p.b,{to:t},e.node.short_id)),l.a.createElement(C,{node:e.node,handleTestRun:e.handleTestRun,handleEnvToggle:e.handleEnvToggle}))},C=function(e){return"inactive"===e.node.environment_state?l.a.createElement(_,{nodeid:e.node.nodeid,status:e.node.status,handleTestRun:e.handleTestRun}):l.a.createElement("span",{className:Object(T.b)(U.buttonsContainer,U.navEntryCommon)},l.a.createElement(S,{envStatus:e.node.environment_state,handleEnvToggle:e.handleEnvToggle,nodeid:e.node.nodeid}),l.a.createElement(_,{nodeid:e.node.nodeid,status:e.node.status,handleTestRun:e.handleTestRun}))},P=function(e){var t=e.node.short_id,n=t===e.selectedLeafID?t:l.a.createElement(p.b,{to:"?selectedLeaf=".concat(encodeURIComponent(t))},t);return l.a.createElement(w.a,{key:t,className:Object(T.b)(z(e.node.status),U.navEntryCommon)},l.a.createElement("span",{className:Object(T.b)(U.navLabel)},n),l.a.createElement(_,{nodeid:e.node.nodeid,status:e.node.status,handleTestRun:e.handleTestRun}))},_=function(e){switch(e.status){case"running":return l.a.createElement(x.a,{icon:I.d,className:Object(T.b)(U.inactiveButton),size:"lg",spin:!0});default:return l.a.createElement(x.a,{icon:I.c,onClick:function(t){t.stopPropagation(),e.handleTestRun(e.nodeid)},className:Object(T.b)(U.runButton),size:"lg"})}},S=function(e){switch(e.envStatus){case"stopped":return l.a.createElement(x.a,{icon:I.f,className:Object(T.b)(U.runButton),onClick:function(t){t.stopPropagation(),e.handleEnvToggle(e.nodeid,!0)},size:"lg"});case"started":return l.a.createElement(x.a,{icon:I.g,className:Object(T.b)(U.runButton),onClick:function(t){t.stopPropagation(),e.handleEnvToggle(e.nodeid,!1)},size:"lg"});case"stopping":return l.a.createElement(x.a,{icon:I.g,className:Object(T.b)(U.inactiveButton),size:"lg"});default:throw new Error("unexpected environment status "+e.envStatus)}},z=function(e){switch(e){case"passed":return U.navEntryPassed;case"failed":return U.navEntryFailed;default:return U.navEntryDefault}},U=T.a.create({buttonsContainer:{width:"3em"},navColumn:{height:"100%",width:k,position:"fixed","z-index":1,top:0,left:0,"overflow-x":"hidden",padding:"1px",background:j},navLabel:{"text-overflow":"ellipsis","white-space":"nowrap",fontSize:"small","max-width":"80%"},runButton:{cursor:"pointer",color:"black","padding-left":"3px","padding-right":"3px",transition:"color 0.3s ease-out 0s",":hover":{color:j}},inactiveButton:{color:j,"padding-left":"3px","padding-right":"3px"},navEntryPassed:{background:"#c0ffbf"},navEntryFailed:{background:"#ff7a7a"},navEntryDefault:{background:y},navEntryCommon:{display:"flex","justify-content":"space-between","align-items":"center"}}),F=n(145),M=n(146),A=function(e){return e.selectedLeaf?l.a.createElement(l.a.Fragment,null,l.a.createElement("div",null,l.a.createElement("span",{className:Object(T.b)(q.title)},e.selectedLeaf.nodeid),l.a.createElement("span",{className:Object(T.b)(q.statusIcon)},J(e.selectedLeaf.status))),l.a.createElement("pre",{className:Object(T.b)(q.longrepr)},e.selectedLeaf.longrepr)):l.a.createElement(H,{message:"Please select a test."})},H=function(e){return l.a.createElement("h1",{className:Object(T.b)(q.message)},e.message)},J=function(e){switch(e){case"passed":return l.a.createElement(x.a,{icon:I.a,color:"green",size:"4x"});case"failed":return l.a.createElement(x.a,{icon:I.e,color:"red",size:"4x"});default:return null}},$=function(e){var t=e.selection.length;if(!t)return l.a.createElement(F.a,null,l.a.createElement(M.a,{key:"home"},l.a.createElement(x.a,{icon:I.b})));var n=e.selection[t-1],a=e.selection.slice(0,t-1);return l.a.createElement(F.a,null,l.a.createElement(M.a,{key:"home"},l.a.createElement(p.b,{to:"/"},l.a.createElement(x.a,{icon:I.b}))),a.map((function(t,n){return l.a.createElement(M.a,{key:t},l.a.createElement(p.b,{to:"/"+e.selection.slice(0,n+1).map(encodeURIComponent).join("/")},t))})),l.a.createElement(M.a,null,n))},q=T.a.create({title:{fontSize:"large","font-weight":"bold","text-overflow":"ellipsis","white-space":"nowrap",padding:"10px"},statusIcon:{float:"right"},longrepr:{padding:"10px"},message:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",textAlign:"center",minHeight:"80vh",color:y}}),G=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={resultTree:null,loading:!1,socket:null,errorMessage:null},a.handleUpdate=a.handleUpdate.bind(Object(u.a)(a)),a.handleTestRun=a.handleTestRun.bind(Object(u.a)(a)),a.handleEnvToggle=a.handleEnvToggle.bind(Object(u.a)(a)),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=E()();this.setState({loading:!0,socket:t},(function(){t.on("update",e.handleUpdate),e.getResultTree()}))}},{key:"getResultTree",value:function(){var e=this;v.a.get("/api/v1/result-tree").then((function(t){e.setState({resultTree:t.data,loading:!1})})).catch((function(t){console.log("API error: "+t),setTimeout((function(){return e.getResultTree()}),100)}))}},{key:"handleUpdate",value:function(e){console.log("Handling websocket update"),this.setState({resultTree:e})}},{key:"handleTestRun",value:function(e){this.state.socket?this.state.socket.emit("run test",e):console.log("Socket connection not yet established")}},{key:"handleEnvToggle",value:function(e,t){this.state.socket?t?this.state.socket.emit("start env",e):this.state.socket.emit("stop env",e):console.log("Socket connection not yet established")}},{key:"render",value:function(){var e=K(this.props.url);if(this.state.loading)return l.a.createElement(V,{message:"Loading...",selection:e});if(this.state.errorMessage)return l.a.createElement(V,{message:this.state.errorMessage,selection:e});try{var t=X(e,this.state.resultTree),n=t.childBranches,a=t.childLeaves;return l.a.createElement(Q,{childBranches:n,childLeaves:a,selection:e,handleTestRun:this.handleTestRun,handleEnvToggle:this.handleEnvToggle})}catch(c){if(c instanceof Z)return l.a.createElement(V,{message:"404 Page Not Found",selection:e});throw c}}}]),n}(l.a.Component),K=function(e){if(!e)return[];var t=e.replace(/^\/+|\/+$/g,"");return 0===t.length?[]:t.split("/").map(decodeURIComponent)},Q=function(e){var t=W().get("selectedLeaf"),n=t?e.childLeaves[t]:null;return l.a.createElement("div",null,l.a.createElement(B,{childBranches:e.childBranches,childLeaves:e.childLeaves,selectedLeafID:t,selection:e.selection,handleTestRun:e.handleTestRun,handleEnvToggle:e.handleEnvToggle}),l.a.createElement("div",{className:Object(T.b)(Y.centrePane)},l.a.createElement($,{selection:e.selection}),l.a.createElement(A,{selectedLeaf:n})))},V=function(e){return l.a.createElement("div",null,l.a.createElement(B,{childBranches:{},childLeaves:{},selectedLeafID:null,selection:[],handleTestRun:function(e){},handleEnvToggle:function(e,t){}}),l.a.createElement("div",{className:Object(T.b)(Y.centrePane)},l.a.createElement($,{selection:e.selection}),l.a.createElement(H,{message:e.message})))},W=function(){return new URLSearchParams(Object(b.e)().search)},X=function(e,t){if(!t)return{childBranches:{},childLeaves:{}};if(0===e.length)return{childBranches:Object(o.a)({},t.short_id,t),childLeaves:{}};var n=e.slice(1).reduce((function(e,t){return null===e||void 0===e?void 0:e.child_branches[t]}),t);if(n)return{childBranches:n.child_branches,childLeaves:n.child_leaves};throw new Z("Not found",e)},Y=T.a.create({centrePane:{"margin-left":k,padding:"10px 10px"}}),Z=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e,a){var l;return Object(i.a)(this,n),(l=t.call(this,e)).selection=void 0,l.selection=a,l}return n}(Object(r.a)(Error)),ee=function(){return l.a.createElement(p.a,null,l.a.createElement(b.a,{path:"/",render:function(e){var t=e.location;return l.a.createElement(G,{url:t.pathname})}}))};n(141);s.a.render(l.a.createElement(ee,null),document.getElementById("root"))}},[[142,1,2]]]);
//# sourceMappingURL=main.5b7c8713.chunk.js.map