<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ProSHADE: ProSHADE_internal_overlay Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ProSHADE
   &#160;<span id="projectnumber">0.7.5.2 (JAN 2021)</span>
   </div>
   <div id="projectbrief">Protein Shape Detection</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespace_pro_s_h_a_d_e__internal__overlay.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ProSHADE_internal_overlay Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This namespace contains all the functions required for map overlays.  
<a href="namespace_pro_s_h_a_d_e__internal__overlay.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a92cc970ba9d1e6ab220a0c947ebd5567"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__overlay.html#a92cc970ba9d1e6ab220a0c947ebd5567">getOptimalRotation</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *staticStructure, <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *movingStructure, proshade_double *eulA, proshade_double *eulB, proshade_double *eulG)</td></tr>
<tr class="memdesc:a92cc970ba9d1e6ab220a0c947ebd5567"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function finds the optimal rotation between two structures as described by the settings object.  <a href="namespace_pro_s_h_a_d_e__internal__overlay.html#a92cc970ba9d1e6ab220a0c947ebd5567">More...</a><br /></td></tr>
<tr class="separator:a92cc970ba9d1e6ab220a0c947ebd5567"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96c978e561ed489efc681f640332256a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__overlay.html#a96c978e561ed489efc681f640332256a">getOptimalTranslation</a> (<a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings, <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *staticStructure, <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *movingStructure, proshade_double *trsX, proshade_double *trsY, proshade_double *trsZ, proshade_double eulA, proshade_double eulB, proshade_double eulG)</td></tr>
<tr class="memdesc:a96c978e561ed489efc681f640332256a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function finds the optimal translation between two structures as described by the settings object given a rotation between the two objects.  <a href="namespace_pro_s_h_a_d_e__internal__overlay.html#a96c978e561ed489efc681f640332256a">More...</a><br /></td></tr>
<tr class="separator:a96c978e561ed489efc681f640332256a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f02ec45f8f865fe5a7142509f48e41a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__overlay.html#a6f02ec45f8f865fe5a7142509f48e41a">computeBeforeAfterZeroCounts</a> (proshade_unsign *addXPre, proshade_unsign *addYPre, proshade_unsign *addZPre, proshade_unsign *addXPost, proshade_unsign *addYPost, proshade_unsign *addZPost, proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim, proshade_unsign xDimIndices, proshade_unsign yDimIndices, proshade_unsign zDimIndices)</td></tr>
<tr class="memdesc:a6f02ec45f8f865fe5a7142509f48e41a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function finds the number of zeroes to be added after and before the structure along each dimension.  <a href="namespace_pro_s_h_a_d_e__internal__overlay.html#a6f02ec45f8f865fe5a7142509f48e41a">More...</a><br /></td></tr>
<tr class="separator:a6f02ec45f8f865fe5a7142509f48e41a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e7fa43107bc9a9fce49d5954a93c962"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__overlay.html#a1e7fa43107bc9a9fce49d5954a93c962">paddMapWithZeroes</a> (proshade_double *oldMap, proshade_double *&amp;newMap, proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim, proshade_unsign xDimIndices, proshade_unsign yDimIndices, proshade_unsign zDimIndices, proshade_unsign addXPre, proshade_unsign addYPre, proshade_unsign addZPre)</td></tr>
<tr class="memdesc:a1e7fa43107bc9a9fce49d5954a93c962"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function adds zeroes before and after the central map and copies the central map values into a new map.  <a href="namespace_pro_s_h_a_d_e__internal__overlay.html#a1e7fa43107bc9a9fce49d5954a93c962">More...</a><br /></td></tr>
<tr class="separator:a1e7fa43107bc9a9fce49d5954a93c962"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f5eacf55d707e1d80d3df360fc0fe91"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__overlay.html#a5f5eacf55d707e1d80d3df360fc0fe91">allocateTranslationFunctionMemory</a> (fftw_complex *&amp;tmpIn1, fftw_complex *&amp;tmpOut1, fftw_complex *&amp;tmpIn2, fftw_complex *&amp;tmpOut2, fftw_complex *&amp;resIn, fftw_complex *&amp;resOut, fftw_plan &amp;forwardFourierObj1, fftw_plan &amp;forwardFourierObj2, fftw_plan &amp;inverseFourierCombo, proshade_unsign xD, proshade_unsign yD, proshade_unsign zD)</td></tr>
<tr class="memdesc:a5f5eacf55d707e1d80d3df360fc0fe91"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allocates the memory for the Fourier transforms required for translation function computation.  <a href="namespace_pro_s_h_a_d_e__internal__overlay.html#a5f5eacf55d707e1d80d3df360fc0fe91">More...</a><br /></td></tr>
<tr class="separator:a5f5eacf55d707e1d80d3df360fc0fe91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a0722746f5c10a2ce4805513cb99fe9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__overlay.html#a2a0722746f5c10a2ce4805513cb99fe9">combineFourierForTranslation</a> (fftw_complex *tmpOut1, fftw_complex *tmpOut2, fftw_complex *&amp;resOut, proshade_unsign xD, proshade_unsign yD, proshade_unsign zD)</td></tr>
<tr class="memdesc:a2a0722746f5c10a2ce4805513cb99fe9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function combines Fourier coefficients of two structures in a way, so that inverse Fourier of the combination will be the translation function.  <a href="namespace_pro_s_h_a_d_e__internal__overlay.html#a2a0722746f5c10a2ce4805513cb99fe9">More...</a><br /></td></tr>
<tr class="separator:a2a0722746f5c10a2ce4805513cb99fe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75e695f0a6b627e6a670c5e379230f4c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__overlay.html#a75e695f0a6b627e6a670c5e379230f4c">findHighestValueInMap</a> (fftw_complex *resIn, proshade_unsign xD, proshade_unsign yD, proshade_unsign zD, proshade_double *trsX, proshade_double *trsY, proshade_double *trsZ, proshade_double *mapPeak)</td></tr>
<tr class="memdesc:a75e695f0a6b627e6a670c5e379230f4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function simply finds the highest value in fftw_complex map and returns its position and value.  <a href="namespace_pro_s_h_a_d_e__internal__overlay.html#a75e695f0a6b627e6a670c5e379230f4c">More...</a><br /></td></tr>
<tr class="separator:a75e695f0a6b627e6a670c5e379230f4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a448b6438ea9979e18af75f419f175603"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__overlay.html#a448b6438ea9979e18af75f419f175603">freeTranslationFunctionMemory</a> (fftw_complex *&amp;tmpIn1, fftw_complex *&amp;tmpOut1, fftw_complex *&amp;tmpIn2, fftw_complex *&amp;tmpOut2, fftw_complex *&amp;resOut, fftw_plan &amp;forwardFourierObj1, fftw_plan &amp;forwardFourierObj2, fftw_plan &amp;inverseFourierCombo)</td></tr>
<tr class="memdesc:a448b6438ea9979e18af75f419f175603"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function releases the memory for the Fourier transforms required for translation function computation.  <a href="namespace_pro_s_h_a_d_e__internal__overlay.html#a448b6438ea9979e18af75f419f175603">More...</a><br /></td></tr>
<tr class="separator:a448b6438ea9979e18af75f419f175603"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78c51dc39b75ffb4731c7219b25e290b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__overlay.html#a78c51dc39b75ffb4731c7219b25e290b">computeAngularThreshold</a> (std::vector&lt; proshade_double &gt; *lonCO, std::vector&lt; proshade_double &gt; *latCO, proshade_unsign angRes)</td></tr>
<tr class="memdesc:a78c51dc39b75ffb4731c7219b25e290b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the angular thresholds for longitude and lattitude angles.  <a href="namespace_pro_s_h_a_d_e__internal__overlay.html#a78c51dc39b75ffb4731c7219b25e290b">More...</a><br /></td></tr>
<tr class="separator:a78c51dc39b75ffb4731c7219b25e290b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac173210899aeeae2e207f9acdd7670a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__overlay.html#ac173210899aeeae2e207f9acdd7670a7">initialiseInverseSHComputation</a> (proshade_unsign shBand, double *&amp;sigR, double *&amp;sigI, double *&amp;rcoeffs, double *&amp;icoeffs, double *&amp;weights, double *&amp;workspace, fftw_plan &amp;idctPlan, fftw_plan &amp;ifftPlan)</td></tr>
<tr class="memdesc:ac173210899aeeae2e207f9acdd7670a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initialises internal variables for inverse Spherical Harmonics computation.  <a href="namespace_pro_s_h_a_d_e__internal__overlay.html#ac173210899aeeae2e207f9acdd7670a7">More...</a><br /></td></tr>
<tr class="separator:ac173210899aeeae2e207f9acdd7670a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This namespace contains all the functions required for map overlays. </p>
<p>The map overlay task does have some specific functions that are betters groupped together for higher clarity of the code and also simple modifications later. This is where these live. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a5f5eacf55d707e1d80d3df360fc0fe91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f5eacf55d707e1d80d3df360fc0fe91">&#9670;&nbsp;</a></span>allocateTranslationFunctionMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_overlay::allocateTranslationFunctionMemory </td>
          <td>(</td>
          <td class="paramtype">fftw_complex *&amp;&#160;</td>
          <td class="paramname"><em>tmpIn1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&amp;&#160;</td>
          <td class="paramname"><em>tmpOut1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&amp;&#160;</td>
          <td class="paramname"><em>tmpIn2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&amp;&#160;</td>
          <td class="paramname"><em>tmpOut2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&amp;&#160;</td>
          <td class="paramname"><em>resIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&amp;&#160;</td>
          <td class="paramname"><em>resOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan &amp;&#160;</td>
          <td class="paramname"><em>forwardFourierObj1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan &amp;&#160;</td>
          <td class="paramname"><em>forwardFourierObj2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan &amp;&#160;</td>
          <td class="paramname"><em>inverseFourierCombo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zD</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allocates the memory for the Fourier transforms required for translation function computation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tmpIn1</td><td>Array to hold the static structure Fourier inputs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmpOut1</td><td>Array to hold the static structure Fourier outputs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmpIn2</td><td>Array to hold the moving structure Fourier inputs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmpOut2</td><td>Array to hold the moving structure Fourier outputs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">resIn</td><td>Array to hold the final translation function values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">resOut</td><td>Array to hold the combined Fourier coefficients of both structures. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">forwardFourierObj1</td><td>FFTW plan for the forward Fourier of the static structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">forwardFourierObj2</td><td>FFTW plan for the forward Fourier of the moving structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inverseFourierCombo</td><td>FFTW plan for the backward Fourier of the combined Fourier factors of both structures. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xD</td><td>The dimension of the X axis of the structures (assumes both structures have the same sizes and sampling). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yD</td><td>The dimension of the Y axis of the structures (assumes both structures have the same sizes and sampling). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zD</td><td>The dimension of the Z axis of the structures (assumes both structures have the same sizes and sampling). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00432">432</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;{</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">//================================================ Allocate memory</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    tmpIn1                                            = <span class="keyword">new</span> fftw_complex[xD * yD * zD];</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    tmpOut1                                           = <span class="keyword">new</span> fftw_complex[xD * yD * zD];</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    tmpIn2                                            = <span class="keyword">new</span> fftw_complex[xD * yD * zD];</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    tmpOut2                                           = <span class="keyword">new</span> fftw_complex[xD * yD * zD];</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    resIn                                             = <span class="keyword">new</span> fftw_complex[xD * yD * zD];</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    resOut                                            = <span class="keyword">new</span> fftw_complex[xD * yD * zD];</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">//================================================ Check memory allocation</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( tmpIn1 , __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( tmpOut1, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( tmpIn2,  __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( tmpOut2, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( resIn,   __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( resOut,  __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">//================================================ Get Fourier transforms of the maps</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    forwardFourierObj1                                = fftw_plan_dft_3d ( xD, yD, zD, tmpIn1, tmpOut1, FFTW_FORWARD , FFTW_ESTIMATE );</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    forwardFourierObj2                                = fftw_plan_dft_3d ( xD, yD, zD, tmpIn2, tmpOut2, FFTW_FORWARD , FFTW_ESTIMATE );</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    inverseFourierCombo                               = fftw_plan_dft_3d ( xD, yD, zD, resOut, resIn  , FFTW_BACKWARD, FFTW_ESTIMATE );</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    return ;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a0722746f5c10a2ce4805513cb99fe9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a0722746f5c10a2ce4805513cb99fe9">&#9670;&nbsp;</a></span>combineFourierForTranslation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_overlay::combineFourierForTranslation </td>
          <td>(</td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>tmpOut1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>tmpOut2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&amp;&#160;</td>
          <td class="paramname"><em>resOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zD</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function combines Fourier coefficients of two structures in a way, so that inverse Fourier of the combination will be the translation function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tmpOut1</td><td>Array holding the static structure Fourier outputs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmpOut2</td><td>Array holding the moving structure Fourier outputs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">resOut</td><td>Array to hold the combined Fourier coefficients of both structures. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xD</td><td>The dimension of the X axis of the structures (assumes both structures have the same sizes and sampling). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yD</td><td>The dimension of the Y axis of the structures (assumes both structures have the same sizes and sampling). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zD</td><td>The dimension of the Z axis of the structures (assumes both structures have the same sizes and sampling). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00497">497</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;{</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordtype">double</span> normFactor                                 = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( xD * yD * zD );</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    proshade_signed h1, k1, l1, hlpPos, arrPos;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    proshade_signed uo2                               = xD / 2;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    proshade_signed vo2                               = yD / 2;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    proshade_signed wo2                               = zD / 2;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="comment">//================================================ Combine the coefficients</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed uIt = 0; uIt &lt; static_cast&lt;proshade_signed&gt; ( xD ); uIt++ )</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed vIt = 0; vIt &lt; static_cast&lt;proshade_signed&gt; ( yD ); vIt++ )</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed wIt = 0; wIt &lt; static_cast&lt;proshade_signed&gt; ( zD ); wIt++ )</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                <span class="comment">//==================================== Convert to HKL</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                <span class="keywordflow">if</span> ( uIt &gt; uo2 ) { h1 = uIt - xD; } <span class="keywordflow">else</span> { h1 = uIt; }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                <span class="keywordflow">if</span> ( vIt &gt; vo2 ) { k1 = vIt - yD; } <span class="keywordflow">else</span> { k1 = vIt; }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                <span class="keywordflow">if</span> ( wIt &gt; wo2 ) { l1 = wIt - zD; } <span class="keywordflow">else</span> { l1 = wIt; }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                <span class="comment">//==================================== Make HKL into indexable numbers</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                <span class="keywordflow">if</span> ( h1 &lt; 0 ) { h1 += xD; }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                <span class="keywordflow">if</span> ( k1 &lt; 0 ) { k1 += yD; }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                <span class="keywordflow">if</span> ( l1 &lt; 0 ) { l1 += zD; }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                <span class="comment">//==================================== Find indices</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                hlpPos                                = l1  + zD * ( k1  + yD * h1 );</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                arrPos                                = wIt + zD * ( vIt + yD * uIt );</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                <span class="comment">//==================================== Combine</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ca5a3aedba75f52aaf707edc4e790f7">ProSHADE_internal_maths::complexMultiplicationConjug</a> ( &amp;tmpOut1[hlpPos][0],</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                                                                       &amp;tmpOut1[hlpPos][1],</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                                                                       &amp;tmpOut2[arrPos][0],</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                                                                       &amp;tmpOut2[arrPos][1],</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                                                       &amp;resOut[hlpPos][0],</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                                                       &amp;resOut[hlpPos][1] );</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                <span class="comment">//==================================== Save</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                resOut[hlpPos][0]                    /= normFactor;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                resOut[hlpPos][1]                    /= normFactor;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    return ;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a78c51dc39b75ffb4731c7219b25e290b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78c51dc39b75ffb4731c7219b25e290b">&#9670;&nbsp;</a></span>computeAngularThreshold()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_overlay::computeAngularThreshold </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; proshade_double &gt; *&#160;</td>
          <td class="paramname"><em>lonCO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double &gt; *&#160;</td>
          <td class="paramname"><em>latCO</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>angRes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the angular thresholds for longitude and lattitude angles. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lonCO</td><td>Pointer to vector where longitude thresholds are to be stored at. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">latCO</td><td>Pointer to vector where lattitude thresholds are to be stored at. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">angRes</td><td>The angular resolution of the computation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l01018">1018</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;{</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="comment">//================================================ Longitude angular thresholds</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt;= angRes; iter++ )</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    {</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a> ( lonCO, <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( iter ) * ( ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( M_PI ) * 2.0 ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( angRes ) ) - ( <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( M_PI ) ) );</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="comment">//================================================ Lattitude angular thresholds</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt;= angRes; iter++ )</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    {</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a> ( latCO, <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( iter ) * ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( M_PI ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( angRes ) ) - ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( M_PI ) / 2.0 ) );</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    }</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    return ;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;     </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6f02ec45f8f865fe5a7142509f48e41a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f02ec45f8f865fe5a7142509f48e41a">&#9670;&nbsp;</a></span>computeBeforeAfterZeroCounts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_overlay::computeBeforeAfterZeroCounts </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign *&#160;</td>
          <td class="paramname"><em>addXPre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign *&#160;</td>
          <td class="paramname"><em>addYPre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign *&#160;</td>
          <td class="paramname"><em>addZPre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign *&#160;</td>
          <td class="paramname"><em>addXPost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign *&#160;</td>
          <td class="paramname"><em>addYPost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign *&#160;</td>
          <td class="paramname"><em>addZPost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xDimIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yDimIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zDimIndices</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function finds the number of zeroes to be added after and before the structure along each dimension. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">addXPre</td><td>Variable pointer where the number of zeroes to be added before the map along X axis is saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addYPre</td><td>Variable pointer where the number of zeroes to be added before the map along Y axis is saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addZPre</td><td>Variable pointer where the number of zeroes to be added before the map along Z axis is saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addXPost</td><td>Variable pointer where the number of zeroes to be added after the map along X axis is saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addYPost</td><td>Variable pointer where the number of zeroes to be added after the map along Y axis is saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addZPost</td><td>Variable pointer where the number of zeroes to be added after the map along Z axis is saved. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xDim</td><td>The X dimension size in indices of the new map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDim</td><td>The Y dimension size in indices of the new map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDim</td><td>The Z dimension size in indices of the new map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xDimIndices</td><td>The X dimension size in indices of the old map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDimIndices</td><td>The Y dimension size in indices of the old map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDimIndices</td><td>The Z dimension size in indices of the old map. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00657">657</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;{</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="comment">//================================================ Compute</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;   *addXPre                                           = ( xDim - xDimIndices ) / 2;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;   *addYPre                                           = ( yDim - yDimIndices ) / 2;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   *addZPre                                           = ( zDim - zDimIndices ) / 2;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;   *addXPost                                          = *addXPre; <span class="keywordflow">if</span> ( ( xDim - xDimIndices ) % 2 == 1 ) { *addXPost += 1; }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;   *addYPost                                          = *addYPre; <span class="keywordflow">if</span> ( ( yDim - yDimIndices ) % 2 == 1 ) { *addYPost += 1; }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   *addZPost                                          = *addZPre; <span class="keywordflow">if</span> ( ( zDim - zDimIndices ) % 2 == 1 ) { *addZPost += 1; }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    </div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    return ;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a75e695f0a6b627e6a670c5e379230f4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75e695f0a6b627e6a670c5e379230f4c">&#9670;&nbsp;</a></span>findHighestValueInMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_overlay::findHighestValueInMap </td>
          <td>(</td>
          <td class="paramtype">fftw_complex *&#160;</td>
          <td class="paramname"><em>resIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>trsX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>trsY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>trsZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>mapPeak</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function simply finds the highest value in fftw_complex map and returns its position and value. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">resIn</td><td>Array holding the translation function values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xD</td><td>The dimension of the X axis of the structures (assumes both structures have the same sizes and sampling). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yD</td><td>The dimension of the Y axis of the structures (assumes both structures have the same sizes and sampling). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zD</td><td>The dimension of the Z axis of the structures (assumes both structures have the same sizes and sampling). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trsX</td><td>Variable to which the X axis translation function peak position will be saved to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trsY</td><td>Variable to which the Y axis translation function peak position will be saved to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trsZ</td><td>Variable to which the Z axis translation function peak position will be saved to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mapPeak</td><td>Variable to which the height of the translation function peak will be saved to. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00558">558</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;{</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    proshade_signed arrPos;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   *mapPeak                                           = 0.0;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="comment">//================================================ Search the map</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">for</span> ( proshade_signed uIt = 0; uIt &lt; static_cast&lt;proshade_signed&gt; ( xD ); uIt++ )</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="keywordflow">for</span> ( proshade_signed vIt = 0; vIt &lt; static_cast&lt;proshade_signed&gt; ( yD ); vIt++ )</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <span class="keywordflow">for</span> ( proshade_signed wIt = 0; wIt &lt; static_cast&lt;proshade_signed&gt; ( zD ); wIt++ )</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                arrPos                                = wIt + zD * ( vIt + yD * uIt );</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                <span class="keywordflow">if</span> ( resIn[arrPos][0] &gt; *mapPeak )</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                   *mapPeak                           = resIn[arrPos][0];</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                   *trsX                              = uIt;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                   *trsY                              = vIt;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                   *trsZ                              = wIt;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    }</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    return ;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a448b6438ea9979e18af75f419f175603"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a448b6438ea9979e18af75f419f175603">&#9670;&nbsp;</a></span>freeTranslationFunctionMemory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_overlay::freeTranslationFunctionMemory </td>
          <td>(</td>
          <td class="paramtype">fftw_complex *&amp;&#160;</td>
          <td class="paramname"><em>tmpIn1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&amp;&#160;</td>
          <td class="paramname"><em>tmpOut1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&amp;&#160;</td>
          <td class="paramname"><em>tmpIn2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&amp;&#160;</td>
          <td class="paramname"><em>tmpOut2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_complex *&amp;&#160;</td>
          <td class="paramname"><em>resOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan &amp;&#160;</td>
          <td class="paramname"><em>forwardFourierObj1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan &amp;&#160;</td>
          <td class="paramname"><em>forwardFourierObj2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan &amp;&#160;</td>
          <td class="paramname"><em>inverseFourierCombo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function releases the memory for the Fourier transforms required for translation function computation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tmpIn1</td><td>Array to hold the static structure Fourier inputs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmpOut1</td><td>Array to hold the static structure Fourier outputs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmpIn2</td><td>Array to hold the moving structure Fourier inputs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tmpOut2</td><td>Array to hold the moving structure Fourier outputs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">resOut</td><td>Array to hold the combined Fourier coefficients of both structures. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">forwardFourierObj1</td><td>FFTW plan for the forward Fourier of the static structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">forwardFourierObj2</td><td>FFTW plan for the forward Fourier of the moving structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inverseFourierCombo</td><td>FFTW plan for the backward Fourier of the combined Fourier factors of both structures. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00471">471</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;{</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">//================================================ Release memory</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    fftw_destroy_plan                                 ( forwardFourierObj1 );</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    fftw_destroy_plan                                 ( forwardFourierObj2 );</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    fftw_destroy_plan                                 ( inverseFourierCombo );</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keyword">delete</span>[] tmpIn1;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keyword">delete</span>[] tmpIn2;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keyword">delete</span>[] tmpOut1;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keyword">delete</span>[] tmpOut2;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keyword">delete</span>[] resOut;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    return ;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a92cc970ba9d1e6ab220a0c947ebd5567"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92cc970ba9d1e6ab220a0c947ebd5567">&#9670;&nbsp;</a></span>getOptimalRotation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_overlay::getOptimalRotation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>staticStructure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>movingStructure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>eulA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>eulB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>eulG</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function finds the optimal rotation between two structures as described by the settings object. </p>
<p>This function takes the settings and two structure classes. It then reads in and processes both structures so that the globally optimal rotation overlay Euler angles are detected. However, this is only the case for rotation along the centre of the map of the second structure; therefore, either use Patterson data (usePhase = false), or be aware that better rotation may exist for different centre of rotation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map symmetry detection. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj1</td><td>A pointer to the data class object of the other ( static ) structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obj2</td><td>A pointer to the data class object of the first ( moving ) structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eulA</td><td>The variable to which the best Euler alpha angle value will be saved to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eulB</td><td>The variable to which the best Euler beta angle value will be saved to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eulG</td><td>The variable to which the best Euler gamma angle value will be saved to. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00154">154</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;{</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">//================================================ Read in the structures</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59f2f2ce1bfdb90432c5a29600fdd9e6">readInStructure</a>                  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a8a032c43a41e79e9d86c5beccb329169">inputFiles</a>.at(0), 0, settings );</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59f2f2ce1bfdb90432c5a29600fdd9e6">readInStructure</a>                  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a8a032c43a41e79e9d86c5beccb329169">inputFiles</a>.at(1), 1, settings );</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">//================================================ Internal data processing  (COM, norm, mask, extra space)</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afcb4202e9ffea1b99c59f73faf06d899">processInternalMap</a>               ( settings );</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afcb4202e9ffea1b99c59f73faf06d899">processInternalMap</a>               ( settings );</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">//================================================ Map to sphere</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a56bfcfacedabd84ec54aa2843d59e014">mapToSpheres</a>                     ( settings );</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a56bfcfacedabd84ec54aa2843d59e014">mapToSpheres</a>                     ( settings );</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">//================================================ Get spherical harmonics</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23f9a5f8f6fb7cf0f0324bc1d83d6090">computeSphericalHarmonics</a>        ( settings );</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23f9a5f8f6fb7cf0f0324bc1d83d6090">computeSphericalHarmonics</a>        ( settings );</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">//================================================ Get the rotation function of the pair</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad409e4556676857224d1f5e00e5b7911">getOverlayRotationFunction</a>       ( settings, staticStructure );</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">//================================================ Get inverse SO(3) map top peak Euler angle values</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__peak_search.html#ae8a54558e9c9c28568c441a601811449">ProSHADE_internal_peakSearch::getBestPeakEulerAngsNaive</a> ( movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">getInvSO3Coeffs</a> (),</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                                              std::min ( staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">getMaxBand</a>() ) * 2,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                                              eulA,  eulB,  eulG, settings );</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    return ;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a96c978e561ed489efc681f640332256a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96c978e561ed489efc681f640332256a">&#9670;&nbsp;</a></span>getOptimalTranslation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_overlay::getOptimalTranslation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *&#160;</td>
          <td class="paramname"><em>settings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>staticStructure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *&#160;</td>
          <td class="paramname"><em>movingStructure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>trsX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>trsY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>trsZ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>eulA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>eulB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>eulG</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function finds the optimal translation between two structures as described by the settings object given a rotation between the two objects. </p>
<p>This function starts by loading and processing the structures according to the settings object (keeping phase is assumed, but callers responsibility). It then applies the required rotation to the second (moing) strucutre and then it follows with zero padding to make sure the structures have the same dimensions (again, it assumes map re-sampling was done, but setting to is callers responsibility). It then computes the translation function, finds the highest peak and returns the positions as well as height of this peak.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">settings</td><td>A pointer to settings class containing all the information required for map overlay computation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">staticStructure</td><td>A pointer to the data class object of the other ( static ) structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">movingStructure</td><td>A pointer to the data class object of the first ( moving ) structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trsX</td><td>The variable to which the best X-axis position value will be saved to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trsY</td><td>The variable to which the best Y-axis position value will be saved to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trsZ</td><td>The variable to which the best Z-axis position value will be saved to. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eulA</td><td>The Euler alpha angle value, by which the moving structure is to be rotated by. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eulB</td><td>The Euler beta angle value, by which the moving structure is to be rotated by. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eulG</td><td>The Euler gamma angle value, by which the moving structure is to be rotated by. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00203">203</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;{    </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">//================================================ Read in the structures</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59f2f2ce1bfdb90432c5a29600fdd9e6">readInStructure</a>                  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a8a032c43a41e79e9d86c5beccb329169">inputFiles</a>.at(0), 0, settings );</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59f2f2ce1bfdb90432c5a29600fdd9e6">readInStructure</a>                  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a8a032c43a41e79e9d86c5beccb329169">inputFiles</a>.at(1), 1, settings );</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">//================================================ Internal data processing  (COM, norm, mask, extra space)</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afcb4202e9ffea1b99c59f73faf06d899">processInternalMap</a>               ( settings );</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afcb4202e9ffea1b99c59f73faf06d899">processInternalMap</a>               ( settings );</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">//================================================ Compute spherical harmonics to allow Fourier space rotation</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a56bfcfacedabd84ec54aa2843d59e014">mapToSpheres</a>                     ( settings );</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23f9a5f8f6fb7cf0f0324bc1d83d6090">computeSphericalHarmonics</a>        ( settings );</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">//================================================ Rotate map </span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8089b5dceb60b2e4c2e65957e24d1f56">rotateMap</a> ( settings, eulA, eulB, eulG );</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">//================================================ Zero padding for smaller structure</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0cdec5190d4b2ae60350f0f6db751d4b">zeroPaddToDims</a>                   ( std::max ( staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">getXDim</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">getXDim</a>() ),</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                                                        std::max ( staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">getYDim</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">getYDim</a>() ),</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                                        std::max ( staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">getZDim</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">getZDim</a>() ) );</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0cdec5190d4b2ae60350f0f6db751d4b">zeroPaddToDims</a>                   ( std::max ( staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">getXDim</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">getXDim</a>() ),</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                                        std::max ( staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">getYDim</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">getYDim</a>() ),</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                                        std::max ( staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">getZDim</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">getZDim</a>() ) );</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 1, <span class="stringliteral">&quot;Starting translation function computation.&quot;</span> );</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">//================================================ Compute the translation function map</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a767640acbf4999201ce9ea86d76ff6a1">computeTranslationMap</a>            ( staticStructure );</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">//================================================ Find highest peak in translation function</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    proshade_double mapPeak                           = 0.0;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    proshade_unsign xDimS                             = staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">getXDim</a>();</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    proshade_unsign yDimS                             = staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">getYDim</a>();</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    proshade_unsign zDimS                             = staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">getZDim</a>();</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__overlay.html#a75e695f0a6b627e6a670c5e379230f4c">ProSHADE_internal_overlay::findHighestValueInMap</a>  ( movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae27a3e92905ca9d5f9a32c4eaacc64ae">getTranslationFnPointer</a>(), xDimS, yDimS, zDimS, trsX, trsY, trsZ, &amp;mapPeak );</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">//================================================ Dont translate over half</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">if</span> ( *trsX &gt; ( xDimS / 2 ) ) { *trsX = *trsX - xDimS; }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">if</span> ( *trsY &gt; ( yDimS / 2 ) ) { *trsY = *trsY - yDimS; }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">if</span> ( *trsZ &gt; ( zDimS / 2 ) ) { *trsZ = *trsZ - zDimS; }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">//================================================ Move map</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    proshade_single xCor                              = ( staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> - movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> ) *</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                                        ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">getXDimSize</a>() ) / staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">getXDim</a>() );</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    proshade_single yCor                              = ( staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> - movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> ) *</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                                        ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">getYDimSize</a>() ) / staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">getYDim</a>() );</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    proshade_single zCor                              = ( staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> - movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> ) *</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                                        ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">getZDimSize</a>() ) / staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">getZDim</a>() );</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    proshade_single xMov                              = staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a471ec29b27c3a402d18b20fee8035f1a">mapCOMProcessChangeX</a> - xCor -</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                                        ( *trsX * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">getXDimSize</a>() ) / staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">getXDim</a>() );</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    proshade_single yMov                              = staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47bf2343b0b50267e8e3732c964b63ea">mapCOMProcessChangeY</a> - yCor -</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                                        ( *trsY * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">getYDimSize</a>() ) / staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">getYDim</a>() );</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    proshade_single zMov                              = staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a487131ae5dc44f8667908bf64725b4ab">mapCOMProcessChangeZ</a> - zCor -</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                                        ( *trsZ * <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">getZDimSize</a>() ) / staticStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">getZDim</a>() );</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">//================================================ Save translation vector back</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   *trsX                                              = -xMov;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   *trsY                                              = -yMov;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   *trsZ                                              = -zMov;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    std::stringstream hlpSS;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot;Optimal map translation distances are &quot;</span> &lt;&lt; *trsX &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; *trsY &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; *trsZ &lt;&lt; <span class="stringliteral">&quot; Angstroms with peak height &quot;</span> &lt;&lt; mapPeak / ( xDimS * yDimS * zDimS );</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">//================================================ Save original from variables for PDB output</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7861a96d94b8f7a8eb2946729c330863">mapMovFromsChangeX</a>               = movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1658311301e365cf17721e864b829c28">mapMovFromsChangeY</a>               = movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a682749f30d2fd19842d96e9b870d76ab">mapMovFromsChangeZ</a>               = movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="comment">//================================================ Move the map</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a037825616c60bef58075284449872642">ProSHADE_internal_mapManip::moveMapByIndices</a>      ( &amp;xMov, &amp;yMov, &amp;zMov, movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">getXDimSize</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">getYDimSize</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">getZDimSize</a>(),</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                                                        movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4c89c860da1836b30a9b2889d3e873ed">getXFromPtr</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#adf61c328db45fcd7692d13a8cde5e092">getXToPtr</a>(),</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                                        movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f0d929d1e013cdd23e956d94b7a40da">getYFromPtr</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac859cbd21b93b9d2ed5f119f4ee57f3f">getYToPtr</a>(),</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                                        movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afbbcec01a6ee7701e3b1d0e61730fadf">getZFromPtr</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a68eb739dd4846a1dd48032eb2cc3f49c">getZToPtr</a>(),</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                                                        movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8a1405b3974697f41c4a73da0cb52a32">getXAxisOrigin</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a298bc9a6aae624a091cd97b842a6b618">getYAxisOrigin</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aeb0242051835b508e9af193dc40a697c">getZAxisOrigin</a>() );</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a>      ( movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1bb8bf1e357cc25f68fe93554e44715d">getInternalMap</a>(), xMov, yMov, zMov,</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                                        movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">getXDimSize</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">getYDimSize</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">getZDimSize</a>(),</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                                        movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">getXDim</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">getYDim</a>(), movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">getZDim</a>() );</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 3, hlpSS.str() );</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a>  ( settings-&gt;<a class="code" href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">verbose</a>, 2, <span class="stringliteral">&quot;Translation function computation complete.&quot;</span> );</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">//================================================ Keep only the change in from and to variables</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7861a96d94b8f7a8eb2946729c330863">mapMovFromsChangeX</a>               = movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">xFrom</a> - movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7861a96d94b8f7a8eb2946729c330863">mapMovFromsChangeX</a>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1658311301e365cf17721e864b829c28">mapMovFromsChangeY</a>               = movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">yFrom</a> - movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1658311301e365cf17721e864b829c28">mapMovFromsChangeY</a>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a682749f30d2fd19842d96e9b870d76ab">mapMovFromsChangeZ</a>               = movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">zFrom</a> - movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a682749f30d2fd19842d96e9b870d76ab">mapMovFromsChangeZ</a>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">//================================================ Compute the optimal rotation centre for co-ordinates</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa48fc72e389e663248d27eedbbf32314">computePdbRotationCentre</a>         ( );</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    movingStructure-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aabab21be3199e734780b5ae8408b9fd5">computeOptimalTranslation</a>        ( eulA, eulB, eulG, *trsX, *trsY, *trsZ );</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    return ;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac173210899aeeae2e207f9acdd7670a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac173210899aeeae2e207f9acdd7670a7">&#9670;&nbsp;</a></span>initialiseInverseSHComputation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_overlay::initialiseInverseSHComputation </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>shBand</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&amp;&#160;</td>
          <td class="paramname"><em>sigR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&amp;&#160;</td>
          <td class="paramname"><em>sigI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&amp;&#160;</td>
          <td class="paramname"><em>rcoeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&amp;&#160;</td>
          <td class="paramname"><em>icoeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&amp;&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&amp;&#160;</td>
          <td class="paramname"><em>workspace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan &amp;&#160;</td>
          <td class="paramname"><em>idctPlan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fftw_plan &amp;&#160;</td>
          <td class="paramname"><em>ifftPlan</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function initialises internal variables for inverse Spherical Harmonics computation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">shBand</td><td>The bandwidth for this particular shell. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigR</td><td>Pointer to be initialised for the real signal values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigI</td><td>Pointer to be initialised for the imaginary signal values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rcoeffs</td><td>Pointer to be initialised for the real coefficient values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">icoeffs</td><td>Pointer to be initialised for the imaginary coefficient values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">weights</td><td>Pointer to be initialised for the transform weight values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">workspace</td><td>Pointer to be initialised for the computation screatch space. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idctPlan</td><td>Pointer reference to the cosine/sine transform plan to be created. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ifftPlan</td><td>Pointer reference to the discrete 3D Fourier transform plan to be created. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00902">902</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;{</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="comment">//================================================ Initialise internal variables</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    proshade_unsign oneDim                            = shBand * 2;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="comment">//================================================ Allocate memory</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    sigR                                              = <span class="keyword">new</span> <span class="keywordtype">double</span> [(oneDim * oneDim * 4)];</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    sigI                                              = sigR + (oneDim * oneDim * 2);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    rcoeffs                                           = <span class="keyword">new</span> <span class="keywordtype">double</span> [(oneDim * oneDim * 2)];</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    icoeffs                                           = rcoeffs + (oneDim * oneDim);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    weights                                           = <span class="keyword">new</span> <span class="keywordtype">double</span> [4 * shBand];</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    workspace                                         = <span class="keyword">new</span> <span class="keywordtype">double</span> [( 20 * shBand * shBand ) + ( 24 * shBand )];</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    </div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="comment">//================================================ Check memory allocation</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( sigR,      __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( rcoeffs,   __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( weights,   __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( workspace, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="comment">//================================================ Create the cosine/sine transform plan</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    idctPlan                                          = fftw_plan_r2r_1d ( oneDim, weights, workspace, FFTW_REDFT01, FFTW_ESTIMATE );</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="comment">//================================================ Set up the discrete Fourier transform</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordtype">int</span> rank, howmany_rank;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    fftw_iodim dims[1], howmany_dims[1];</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    rank                                              = 1;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    dims[0].n                                         = 2 * shBand;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    dims[0].is                                        = 2 * shBand;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    dims[0].os                                        = 1;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    howmany_rank                                      = 1;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    howmany_dims[0].n                                 = 2 * shBand;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    howmany_dims[0].is                                = 1;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    howmany_dims[0].os                                = 2 * shBand;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="comment">//================================================ Create the discrete Fourier transform</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    ifftPlan                                          = fftw_plan_guru_split_dft ( rank, dims, howmany_rank, howmany_dims, sigR, sigI, rcoeffs, icoeffs, FFTW_ESTIMATE );</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    return ;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1e7fa43107bc9a9fce49d5954a93c962"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e7fa43107bc9a9fce49d5954a93c962">&#9670;&nbsp;</a></span>paddMapWithZeroes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_overlay::paddMapWithZeroes </td>
          <td>(</td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>oldMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&amp;&#160;</td>
          <td class="paramname"><em>newMap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zDim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>xDimIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>yDimIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>zDimIndices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>addXPre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>addYPre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>addZPre</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function adds zeroes before and after the central map and copies the central map values into a new map. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">oldMap</td><td>The original, unpadded map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">newMap</td><td>The array to which the new map will be saved into. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xDim</td><td>The X dimension size of the new map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDim</td><td>The Y dimension size of the new map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDim</td><td>The Z dimension size of the new map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">xDimIndices</td><td>The X dimension size in indices of the old map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">yDimIndices</td><td>The Y dimension size in indices of the old map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">zDimIndices</td><td>The Z dimension size in indices of the old map. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addXPre</td><td>How many zeroes are to be added before the central map along the X axis? </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addYPre</td><td>How many zeroes are to be added before the central map along the Y axis? </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">addZPre</td><td>How many zeroes are to be added before the central map along the Z axis? </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00686">686</a> of file <a class="el" href="_pro_s_h_a_d_e__overlay_8cpp_source.html">ProSHADE_overlay.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;{</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    proshade_unsign newMapIndex                       = 0;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    proshade_unsign oldMapIndex                       = 0;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">//================================================ Copy and padd as appropriate</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign xIt = 0; xIt &lt; xDim; xIt++ )</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign yIt = 0; yIt &lt; yDim; yIt++ )</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        {</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign zIt = 0; zIt &lt; zDim; zIt++ )</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                <span class="comment">//==================================== Find map location</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                newMapIndex                           = zIt + zDim * ( yIt + yDim * xIt );</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                <span class="comment">//==================================== If less than needed, add zero</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                <span class="keywordflow">if</span> ( xIt &lt; addXPre ) { newMap[newMapIndex] = 0.0; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                <span class="keywordflow">if</span> ( yIt &lt; addYPre ) { newMap[newMapIndex] = 0.0; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                <span class="keywordflow">if</span> ( zIt &lt; addZPre ) { newMap[newMapIndex] = 0.0; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                <span class="comment">//==================================== If more than needed, add zero</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                <span class="keywordflow">if</span> ( xIt &gt;= ( addXPre + xDimIndices ) ) { newMap[newMapIndex] = 0.0; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                <span class="keywordflow">if</span> ( yIt &gt;= ( addYPre + yDimIndices ) ) { newMap[newMapIndex] = 0.0; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                <span class="keywordflow">if</span> ( zIt &gt;= ( addZPre + zDimIndices ) ) { newMap[newMapIndex] = 0.0; <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                <span class="comment">//==================================== If not padding, copy original values</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                oldMapIndex                           = (zIt-addZPre) + zDimIndices * ( (yIt-addYPre) + yDimIndices * (xIt-addXPre) );</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                newMap[newMapIndex]                   = oldMap[oldMapIndex];</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        }</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    }</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="comment">//======================================== Done</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    return ;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a23f9a5f8f6fb7cf0f0324bc1d83d6090"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a23f9a5f8f6fb7cf0f0324bc1d83d6090">ProSHADE_internal_data::ProSHADE_data::computeSphericalHarmonics</a></div><div class="ttdeci">void computeSphericalHarmonics(ProSHADE_settings *settings)</div><div class="ttdoc">This function computes the spherical harmonics decomposition for the whole structure.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01542">ProSHADE_data.cpp:1542</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a7861a96d94b8f7a8eb2946729c330863"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a7861a96d94b8f7a8eb2946729c330863">ProSHADE_internal_data::ProSHADE_data::mapMovFromsChangeX</a></div><div class="ttdeci">proshade_double mapMovFromsChangeX</div><div class="ttdoc">When the map is translated, the xFrom and xTo values are changed. This variable holds how much they h...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00094">ProSHADE_data.hpp:94</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ad409e4556676857224d1f5e00e5b7911"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ad409e4556676857224d1f5e00e5b7911">ProSHADE_internal_data::ProSHADE_data::getOverlayRotationFunction</a></div><div class="ttdeci">void getOverlayRotationFunction(ProSHADE_settings *settings, ProSHADE_internal_data::ProSHADE_data *obj2)</div><div class="ttdoc">This function computes the overlay rotation function (i.e. the correlation function in SO(3) space).</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00035">ProSHADE_overlay.cpp:35</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a14980cdf619bcda026b9aad282c2064b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a14980cdf619bcda026b9aad282c2064b">ProSHADE_internal_data::ProSHADE_data::zFrom</a></div><div class="ttdeci">proshade_signed zFrom</div><div class="ttdoc">This is the starting index along the z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00112">ProSHADE_data.hpp:112</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_af4d641d62864e4adf67c1365b0960970"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#af4d641d62864e4adf67c1365b0960970">ProSHADE_internal_data::ProSHADE_data::getZDimSize</a></div><div class="ttdeci">proshade_single getZDimSize(void)</div><div class="ttdoc">This function allows access to the map size in angstroms along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03238">ProSHADE_data.cpp:3238</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aabab21be3199e734780b5ae8408b9fd5"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aabab21be3199e734780b5ae8408b9fd5">ProSHADE_internal_data::ProSHADE_data::computeOptimalTranslation</a></div><div class="ttdeci">void computeOptimalTranslation(proshade_double eulA, proshade_double eulB, proshade_double eulG, proshade_double trsX, proshade_double trsY, proshade_double trsZ)</div><div class="ttdoc">This function computes and saves the optimal translation vector from the already determined translati...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00109">ProSHADE_overlay.cpp:109</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8a1405b3974697f41c4a73da0cb52a32"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8a1405b3974697f41c4a73da0cb52a32">ProSHADE_internal_data::ProSHADE_data::getXAxisOrigin</a></div><div class="ttdeci">proshade_signed * getXAxisOrigin(void)</div><div class="ttdoc">This function allows access to the map X axis origin value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03338">ProSHADE_data.cpp:3338</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a51d7b9d87d536ef0c48d820872bc9185"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a51d7b9d87d536ef0c48d820872bc9185">ProSHADE_internal_data::ProSHADE_data::getXDimSize</a></div><div class="ttdeci">proshade_single getXDimSize(void)</div><div class="ttdoc">This function allows access to the map size in angstroms along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03218">ProSHADE_data.cpp:3218</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1bb8bf1e357cc25f68fe93554e44715d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1bb8bf1e357cc25f68fe93554e44715d">ProSHADE_internal_data::ProSHADE_data::getInternalMap</a></div><div class="ttdeci">proshade_double *&amp; getInternalMap(void)</div><div class="ttdoc">This function allows access to the first map array value address.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03368">ProSHADE_data.cpp:3368</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae477e3c0d7b866e6069d8603950afe51"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae477e3c0d7b866e6069d8603950afe51">ProSHADE_internal_data::ProSHADE_data::getYDimSize</a></div><div class="ttdeci">proshade_single getYDimSize(void)</div><div class="ttdoc">This function allows access to the map size in angstroms along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03228">ProSHADE_data.cpp:3228</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a471ec29b27c3a402d18b20fee8035f1a"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a471ec29b27c3a402d18b20fee8035f1a">ProSHADE_internal_data::ProSHADE_data::mapCOMProcessChangeX</a></div><div class="ttdeci">proshade_double mapCOMProcessChangeX</div><div class="ttdoc">The change in X axis between the creation of the structure (originalMapXCom) and just before rotation...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00097">ProSHADE_data.hpp:97</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a94dfbe2867f4e294dbb49284881fcb2a"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a94dfbe2867f4e294dbb49284881fcb2a">ProSHADE_internal_mapManip::moveMapByFourier</a></div><div class="ttdeci">void moveMapByFourier(proshade_double *&amp;map, proshade_single xMov, proshade_single yMov, proshade_single zMov, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed xDim, proshade_signed yDim, proshade_signed zDim)</div><div class="ttdoc">Function for moving map back to original PDB location by using Fourier transformation.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00792">ProSHADE_mapManip.cpp:792</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a487131ae5dc44f8667908bf64725b4ab"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a487131ae5dc44f8667908bf64725b4ab">ProSHADE_internal_data::ProSHADE_data::mapCOMProcessChangeZ</a></div><div class="ttdeci">proshade_double mapCOMProcessChangeZ</div><div class="ttdoc">The change in Z axis between the creation of the structure (originalMapZCom) and just before rotation...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00099">ProSHADE_data.hpp:99</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aa48fc72e389e663248d27eedbbf32314"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aa48fc72e389e663248d27eedbbf32314">ProSHADE_internal_data::ProSHADE_data::computePdbRotationCentre</a></div><div class="ttdeci">void computePdbRotationCentre(void)</div><div class="ttdoc">This function computes the optimal rotation centre for co-ordinates.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00068">ProSHADE_overlay.cpp:68</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a4c89c860da1836b30a9b2889d3e873ed"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a4c89c860da1836b30a9b2889d3e873ed">ProSHADE_internal_data::ProSHADE_data::getXFromPtr</a></div><div class="ttdeci">proshade_signed * getXFromPtr(void)</div><div class="ttdoc">This function allows access to the map start along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03278">ProSHADE_data.cpp:3278</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a89094c73ae033812d4df0bd846e03442"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a89094c73ae033812d4df0bd846e03442">ProSHADE_settings::verbose</a></div><div class="ttdeci">proshade_signed verbose</div><div class="ttdoc">Should the software report on the progress, or just be quiet? Value between -1 (nothing) and 4 (loud)</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00192">ProSHADE_settings.hpp:192</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a68c3eafaeea1c1873c33525f337f9d0b"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a></div><div class="ttdeci">void addToDoubleVector(std::vector&lt; proshade_double &gt; *vecToAddTo, proshade_double elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00077">ProSHADE_misc.cpp:77</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a3bc44913222e67ab861dd1e5838c1ae1"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a3bc44913222e67ab861dd1e5838c1ae1">ProSHADE_internal_data::ProSHADE_data::getXDim</a></div><div class="ttdeci">proshade_unsign getXDim(void)</div><div class="ttdoc">This function allows access to the map size in indices along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03248">ProSHADE_data.cpp:3248</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a8089b5dceb60b2e4c2e65957e24d1f56"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a8089b5dceb60b2e4c2e65957e24d1f56">ProSHADE_internal_data::ProSHADE_data::rotateMap</a></div><div class="ttdeci">void rotateMap(ProSHADE_settings *settings, proshade_double eulerAlpha, proshade_double eulerBeta, proshade_double eulerGamma)</div><div class="ttdoc">This function rotates a map based on the given Euler angles.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00736">ProSHADE_overlay.cpp:736</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a56bfcfacedabd84ec54aa2843d59e014"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a56bfcfacedabd84ec54aa2843d59e014">ProSHADE_internal_data::ProSHADE_data::mapToSpheres</a></div><div class="ttdeci">void mapToSpheres(ProSHADE_settings *settings)</div><div class="ttdoc">This function converts the internal map onto a set of concentric spheres.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01499">ProSHADE_data.cpp:1499</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a1658311301e365cf17721e864b829c28"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a1658311301e365cf17721e864b829c28">ProSHADE_internal_data::ProSHADE_data::mapMovFromsChangeY</a></div><div class="ttdeci">proshade_double mapMovFromsChangeY</div><div class="ttdoc">When the map is translated, the yFrom and yTo values are changed. This variable holds how much they h...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00095">ProSHADE_data.hpp:95</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__peak_search_html_ae8a54558e9c9c28568c441a601811449"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__peak_search.html#ae8a54558e9c9c28568c441a601811449">ProSHADE_internal_peakSearch::getBestPeakEulerAngsNaive</a></div><div class="ttdeci">void getBestPeakEulerAngsNaive(proshade_complex *map, proshade_unsign dim, proshade_double *eulA, proshade_double *eulB, proshade_double *eulG, ProSHADE_settings *settings)</div><div class="ttdoc">This function finds the highest peaks optimised Euler angles using the &quot;naive&quot; approach.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__peak_search_8cpp_source.html#l00351">ProSHADE_peakSearch.cpp:351</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a767640acbf4999201ce9ea86d76ff6a1"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a767640acbf4999201ce9ea86d76ff6a1">ProSHADE_internal_data::ProSHADE_data::computeTranslationMap</a></div><div class="ttdeci">void computeTranslationMap(ProSHADE_internal_data::ProSHADE_data *obj1)</div><div class="ttdoc">This function does the computation of the translation map and saves results internally.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00389">ProSHADE_overlay.cpp:389</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afef6a064a54eb016776cb0879efb0b31"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afef6a064a54eb016776cb0879efb0b31">ProSHADE_internal_data::ProSHADE_data::xFrom</a></div><div class="ttdeci">proshade_signed xFrom</div><div class="ttdoc">This is the starting index along the x axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00110">ProSHADE_data.hpp:110</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a152b43815a3d3debd4b60751d9c8afdd"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a152b43815a3d3debd4b60751d9c8afdd">ProSHADE_internal_data::ProSHADE_data::getMaxBand</a></div><div class="ttdeci">proshade_unsign getMaxBand(void)</div><div class="ttdoc">This function returns the maximum band value for the object.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02939">ProSHADE_data.cpp:2939</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a50c884973add562558803a45991bbf19"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a50c884973add562558803a45991bbf19">ProSHADE_internal_data::ProSHADE_data::getYDim</a></div><div class="ttdeci">proshade_unsign getYDim(void)</div><div class="ttdoc">This function allows access to the map size in indices along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03258">ProSHADE_data.cpp:3258</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afcb4202e9ffea1b99c59f73faf06d899"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afcb4202e9ffea1b99c59f73faf06d899">ProSHADE_internal_data::ProSHADE_data::processInternalMap</a></div><div class="ttdeci">void processInternalMap(ProSHADE_settings *settings)</div><div class="ttdoc">This function simply clusters several other functions which should be called together.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l01398">ProSHADE_data.cpp:1398</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ae27a3e92905ca9d5f9a32c4eaacc64ae"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ae27a3e92905ca9d5f9a32c4eaacc64ae">ProSHADE_internal_data::ProSHADE_data::getTranslationFnPointer</a></div><div class="ttdeci">proshade_complex * getTranslationFnPointer(void)</div><div class="ttdoc">This function allows access to the translation function through a pointer.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03378">ProSHADE_data.cpp:3378</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a034af93b9152fb2db675d5632a4ebc6d"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a034af93b9152fb2db675d5632a4ebc6d">ProSHADE_internal_data::ProSHADE_data::getZDim</a></div><div class="ttdeci">proshade_unsign getZDim(void)</div><div class="ttdoc">This function allows access to the map size in indices along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03268">ProSHADE_data.cpp:3268</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__overlay_html_a75e695f0a6b627e6a670c5e379230f4c"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__overlay.html#a75e695f0a6b627e6a670c5e379230f4c">ProSHADE_internal_overlay::findHighestValueInMap</a></div><div class="ttdeci">void findHighestValueInMap(fftw_complex *resIn, proshade_unsign xD, proshade_unsign yD, proshade_unsign zD, proshade_double *trsX, proshade_double *trsY, proshade_double *trsZ, proshade_double *mapPeak)</div><div class="ttdoc">This function simply finds the highest value in fftw_complex map and returns its position and value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00558">ProSHADE_overlay.cpp:558</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a682749f30d2fd19842d96e9b870d76ab"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a682749f30d2fd19842d96e9b870d76ab">ProSHADE_internal_data::ProSHADE_data::mapMovFromsChangeZ</a></div><div class="ttdeci">proshade_double mapMovFromsChangeZ</div><div class="ttdoc">When the map is translated, the zFrom and zTo values are changed. This variable holds how much they h...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00096">ProSHADE_data.hpp:96</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_ac859cbd21b93b9d2ed5f119f4ee57f3f"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#ac859cbd21b93b9d2ed5f119f4ee57f3f">ProSHADE_internal_data::ProSHADE_data::getYToPtr</a></div><div class="ttdeci">proshade_signed * getYToPtr(void)</div><div class="ttdoc">This function allows access to the map last position along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03318">ProSHADE_data.cpp:3318</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_aeb0242051835b508e9af193dc40a697c"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#aeb0242051835b508e9af193dc40a697c">ProSHADE_internal_data::ProSHADE_data::getZAxisOrigin</a></div><div class="ttdeci">proshade_signed * getZAxisOrigin(void)</div><div class="ttdoc">This function allows access to the map Z axis origin value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03358">ProSHADE_data.cpp:3358</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_af556836aa9286c1571196de442a6b493"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a></div><div class="ttdeci">void checkMemoryAllocation(chVar checkVar, std::string fileP, unsigned int lineP, std::string funcP, std::string infoP=&quot;This error may occurs when ProSHADE requests memory to be\n                    : allocated to it and this operation fails. This could\n                    : happen when not enough memory is available, either due to\n                    : other processes using a lot of memory, or when the machine\n                    : does not have sufficient memory available. Re-run to see\n                    : if this problem persists.&quot;)</div><div class="ttdoc">Checks if memory was allocated properly.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8hpp_source.html#l00065">ProSHADE_misc.hpp:65</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_adf61c328db45fcd7692d13a8cde5e092"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#adf61c328db45fcd7692d13a8cde5e092">ProSHADE_internal_data::ProSHADE_data::getXToPtr</a></div><div class="ttdeci">proshade_signed * getXToPtr(void)</div><div class="ttdoc">This function allows access to the map last position along the X axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03308">ProSHADE_data.cpp:3308</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5f0d929d1e013cdd23e956d94b7a40da"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5f0d929d1e013cdd23e956d94b7a40da">ProSHADE_internal_data::ProSHADE_data::getYFromPtr</a></div><div class="ttdeci">proshade_signed * getYFromPtr(void)</div><div class="ttdoc">This function allows access to the map start along the Y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03288">ProSHADE_data.cpp:3288</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a47bf2343b0b50267e8e3732c964b63ea"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a47bf2343b0b50267e8e3732c964b63ea">ProSHADE_internal_data::ProSHADE_data::mapCOMProcessChangeY</a></div><div class="ttdeci">proshade_double mapCOMProcessChangeY</div><div class="ttdoc">The change in Y axis between the creation of the structure (originalMapYCom) and just before rotation...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00098">ProSHADE_data.hpp:98</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a2eb10989a2f8d46b849cdaf8410b68be"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a2eb10989a2f8d46b849cdaf8410b68be">ProSHADE_internal_data::ProSHADE_data::getInvSO3Coeffs</a></div><div class="ttdeci">proshade_complex * getInvSO3Coeffs(void)</div><div class="ttdoc">This function allows access to the inverse SO(3) coefficients array.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03166">ProSHADE_data.cpp:3166</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a5d47aafdd2ec9912225c3c44e2bbc4d8"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a5d47aafdd2ec9912225c3c44e2bbc4d8">ProSHADE_internal_data::ProSHADE_data::yFrom</a></div><div class="ttdeci">proshade_signed yFrom</div><div class="ttdoc">This is the starting index along the y axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8hpp_source.html#l00111">ProSHADE_data.hpp:111</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__settings_html_a8a032c43a41e79e9d86c5beccb329169"><div class="ttname"><a href="class_pro_s_h_a_d_e__settings.html#a8a032c43a41e79e9d86c5beccb329169">ProSHADE_settings::inputFiles</a></div><div class="ttdeci">std::vector&lt; std::string &gt; inputFiles</div><div class="ttdoc">This vector contains the filenames of all input structure files.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__settings_8hpp_source.html#l00099">ProSHADE_settings.hpp:99</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a2ca5a3aedba75f52aaf707edc4e790f7"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a2ca5a3aedba75f52aaf707edc4e790f7">ProSHADE_internal_maths::complexMultiplicationConjug</a></div><div class="ttdeci">void complexMultiplicationConjug(proshade_double *r1, proshade_double *i1, proshade_double *r2, proshade_double *i2, proshade_double *retReal, proshade_double *retImag)</div><div class="ttdoc">Function to multiply two complex numbers by using the second number's conjugate.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l00062">ProSHADE_maths.cpp:62</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a298bc9a6aae624a091cd97b842a6b618"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a298bc9a6aae624a091cd97b842a6b618">ProSHADE_internal_data::ProSHADE_data::getYAxisOrigin</a></div><div class="ttdeci">proshade_signed * getYAxisOrigin(void)</div><div class="ttdoc">This function allows access to the map Y axis origin value.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03348">ProSHADE_data.cpp:3348</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__messages_html_a6aa8cdb600cad623409802cfaed494fa"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__messages.html#a6aa8cdb600cad623409802cfaed494fa">ProSHADE_internal_messages::printProgressMessage</a></div><div class="ttdeci">void printProgressMessage(proshade_signed verbose, proshade_signed messageLevel, std::string message)</div><div class="ttdoc">General stdout message printing.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__messages_8cpp_source.html#l00070">ProSHADE_messages.cpp:70</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__map_manip_html_a037825616c60bef58075284449872642"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__map_manip.html#a037825616c60bef58075284449872642">ProSHADE_internal_mapManip::moveMapByIndices</a></div><div class="ttdeci">void moveMapByIndices(proshade_single *xMov, proshade_single *yMov, proshade_single *zMov, proshade_single xAngs, proshade_single yAngs, proshade_single zAngs, proshade_signed *xFrom, proshade_signed *xTo, proshade_signed *yFrom, proshade_signed *yTo, proshade_signed *zFrom, proshade_signed *zTo, proshade_signed *xOrigin, proshade_signed *yOrigin, proshade_signed *zOrigin)</div><div class="ttdoc">Function for moving map back to original PDB location by changing the indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__map_manip_8cpp_source.html#l00744">ProSHADE_mapManip.cpp:744</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a0cdec5190d4b2ae60350f0f6db751d4b"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a0cdec5190d4b2ae60350f0f6db751d4b">ProSHADE_internal_data::ProSHADE_data::zeroPaddToDims</a></div><div class="ttdeci">void zeroPaddToDims(proshade_unsign xDim, proshade_unsign yDim, proshade_unsign zDim)</div><div class="ttdoc">This function changes the size of a structure to fit the supplied new limits.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__overlay_8cpp_source.html#l00598">ProSHADE_overlay.cpp:598</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a59f2f2ce1bfdb90432c5a29600fdd9e6"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a59f2f2ce1bfdb90432c5a29600fdd9e6">ProSHADE_internal_data::ProSHADE_data::readInStructure</a></div><div class="ttdeci">void readInStructure(std::string fName, proshade_unsign inputO, ProSHADE_settings *settings)</div><div class="ttdoc">This function initialises the basic ProSHADE_data variables and reads in a single structure.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l00447">ProSHADE_data.cpp:447</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_afbbcec01a6ee7701e3b1d0e61730fadf"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#afbbcec01a6ee7701e3b1d0e61730fadf">ProSHADE_internal_data::ProSHADE_data::getZFromPtr</a></div><div class="ttdeci">proshade_signed * getZFromPtr(void)</div><div class="ttdoc">This function allows access to the map start along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03298">ProSHADE_data.cpp:3298</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data_html_a68eb739dd4846a1dd48032eb2cc3f49c"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html#a68eb739dd4846a1dd48032eb2cc3f49c">ProSHADE_internal_data::ProSHADE_data::getZToPtr</a></div><div class="ttdeci">proshade_signed * getZToPtr(void)</div><div class="ttdoc">This function allows access to the map last position along the Z axis.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l03328">ProSHADE_data.cpp:3328</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_pro_s_h_a_d_e__internal__overlay.html">ProSHADE_internal_overlay</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
