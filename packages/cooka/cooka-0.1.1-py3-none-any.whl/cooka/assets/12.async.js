(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{vw9H:function(e,a,t){"use strict";t.r(a);t("y8nQ");var l=t("Vl3Y"),s=(t("IzEo"),t("bx4M")),o=(t("sPJy"),t("bE4q")),n=(t("7Kak"),t("9yH6")),d=t("qIgq"),c=t.n(d),r=t("q1tI"),u=t.n(r),p=t("/MKj"),i=t("Ty5D"),m=t("jehZ"),b=t.n(m),f=t("p0pE"),g=t.n(f),j=(t("miYZ"),t("tsqr")),O=(t("DZo9"),t("8z0m")),S=t("LtfV"),E=t("Qu0c"),v=t.n(E),y=t("LLXN"),M=t("ygAv"),w=t("olQp"),F=t("7/+/"),x=O["a"].Dragger,I=e=>{var a=e.dispatch,t=e.location,s=e.uploadFile.pollJobResponse,o=l["a"].useForm(),n=c()(o,1),d=n[0],p=Object(r["useState"])("whole_data"),i=c()(p,2),m=i[0],f=i[1],O=Object(r["useState"])(50),E=c()(O,2),I=E[0],N=E[1],h=Object(r["useState"])(null),_=c()(h,2),T=_[0],D=_[1],k=Object(r["useState"])(F["StepStatusIcon"]["todo"]),U=c()(k,2),J=U[0],z=U[1],C=Object(r["useState"])(F["StepStatusIcon"]["todo"]),q=c()(C,2),R=q[0],B=q[1],L=Object(r["useState"])(F["StepStatusIcon"]["todo"]),V=c()(L,2),P=V[0],Q=V[1],Z=Object(r["useState"])(Object(y["formatMessage"])({id:"upload.prepare"})),A=c()(Z,2),H=A[0],K=A[1],X=Object(r["useState"])(Object(y["formatMessage"])({id:"upload.prepare"})),Y=c()(X,2),G=Y[0],W=Y[1],$=Object(r["useState"])(Object(y["formatMessage"])({id:"upload.prepare"})),ee=c()($,2),ae=ee[0],te=ee[1];Object(r["useEffect"])(()=>{if(null!==s&&void 0!==s){var e=s.data,a=Object(M["d"])(e.steps),t=a[F["UploadStepType"].upload];void 0!==t&&null!==t&&"succeed"===t.status&&(z(F["StepStatusIcon"].done),K("".concat(Object(y["formatMessage"])({id:"upload.hintUploadFile"},{elapsed:t.took.toFixed(2),fileSize:Object(M["b"])(t.extension.file_size)}))),B(F["StepStatusIcon"].doing),W(Object(y["formatMessage"])({id:"upload.loading"})));var l=a[F["UploadStepType"].load];if(void 0!==l&&null!==l)if("succeed"===l.status){var o=l["extension"]["n_rows"],n=l["extension"]["n_cols"],d=l["extension"]["n_rows_used"],c=l["took"];B(F["StepStatusIcon"]["done"]),W(Object(y["formatMessage"])({id:"upload.hintLoadData"},{elapsed:c.toFixed(2),nRows:o,nColumns:n,nRowsUsed:d})),Q(F["StepStatusIcon"]["doing"]),te(Object(y["formatMessage"])({id:"upload.analysising"}))}else B(F["StepStatusIcon"]["undone"]),W(Object(y["formatMessage"])({id:"upload.fail"}));var r=a[F["UploadStepType"].analyze];void 0!==r&&null!==r&&("succeed"===r.status?(Q(F["StepStatusIcon"]["done"]),B(F["StepStatusIcon"]["done"]),te("".concat(Object(y["formatMessage"])({id:"upload.hintAnalysis"},{elapsed:r.took.toFixed(2),nContinuous:r.extension.feature_summary.continuous,nCategorical:r.extension.feature_summary.categorical,nDatetime:r.extension.feature_summary.datetime})))):"failed"===r.status&&(Q(F["StepStatusIcon"]["undone"]),te(Object(y["formatMessage"])({id:"upload.fail"}))))}},[s]);var le=e=>{isNaN(e)||N(e)},se={name:"file",multiple:!1,accept:".csv, .tsv",headers:{"File-Name":T},action:"/api/resource",beforeUpload:e=>{if(e.size>128e6)return j["b"].warning(Object(y["formatMessage"])({id:"upload.big"})),!1;D(e.name)},showUploadList:!1,onChange(e){var l=e.file.status;if("uploading"===l&&(z(F["StepStatusIcon"]["doing"]),K(Object(y["formatMessage"])({id:"upload.uploading"}))),"done"===l){var s=e.file.response.data.path,o=e.file.response.data.took,n="random_rows"===m?{n_rows:d.getFieldsValue().n_rows}:{percentage:I},c=t.query.sourceType;a({type:"uploadFile/createTempDataset",payload:g()({sample_strategy:m},n,{file_path:s,upload_took:o,source_type:c})})}else"error"===l&&(z(F["StepStatusIcon"]["undone"]),K(Object(y["formatMessage"])({id:"upload.uploadFail"})),j["b"].error("".concat(e.file.name," file upload failed.")))}};return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:v.a.main},Object(w["makeSampleDiv"])(f,m,d,le,I),u.a.createElement("div",{className:v.a.fileUpload},u.a.createElement("dl",null,u.a.createElement("dt",null,Object(y["formatMessage"])({id:"upload.upload"})),Object(w["makeCsvFileTip"])()),u.a.createElement(x,b()({},se,{style:{width:"85%"}}),u.a.createElement("p",{className:"ant-upload-drag-icon"},u.a.createElement(S["a"],null)),u.a.createElement("p",{className:"ant-upload-text"},Object(y["formatMessage"])({id:"upload.uploadBox"}))))),u.a.createElement("div",{className:v.a.process},u.a.createElement("dl",null,u.a.createElement("dt",null,J,u.a.createElement("span",{className:v.a.stepTitle},"1. ",Object(y["formatMessage"])({id:"upload.uploadStep"}))),u.a.createElement("dd",{className:v.a.stepTips},H)),u.a.createElement("dl",null,u.a.createElement("dt",null,R,u.a.createElement("span",{className:v.a.stepTitle},"2. ",Object(y["formatMessage"])({id:"upload.loadData"}))),u.a.createElement("dd",{className:v.a.stepTips},G)),u.a.createElement("dl",null,u.a.createElement("dt",null,P,u.a.createElement("span",{className:v.a.stepTitle},"3. ",Object(y["formatMessage"])({id:"upload.analysisData"}))),u.a.createElement("dd",{className:v.a.stepTips},ae))))},N=Object(i["o"])(Object(p["c"])(e=>{var a=e.uploadFile;return{uploadFile:a}})(I)),h=t("X/SJ"),_=t("5ahD"),T=Object(i["o"])(Object(p["c"])(e=>{var a=e.uploadFile;return{pollJobResponse:a.pollJobResponse}})(w["CreateDatasetFormPage"])),D=e=>{var a=e.uploadFile,t=a.datasetName,d=a.pollJobResponse,p=(e.dispatch,Object(r["useState"])("a")),i=c()(p,2),m=i[0],b=i[1],f=Object(r["useState"])(!1),g=c()(f,2),j=g[0],O=g[1];Object(r["useEffect"])(()=>{if(null!==d&&void 0!==d){var e=d.data,a=Object(M["d"])(e.steps),t=a[F["UploadStepType"].analyze];void 0!==t&&null!==t&&"succeed"===t.status&&O(!0)}},[d]);var S=e=>{b(e.target.value)},E=u.a.createElement(n["a"].Group,{onChange:S,defaultValue:m},u.a.createElement(n["a"].Button,{value:"a"},Object(y["formatMessage"])({id:"upload.upload"})),j&&u.a.createElement(u.a.Fragment,null,u.a.createElement(n["a"].Button,{value:"b"},Object(y["formatMessage"])({id:"extra.preview"})),u.a.createElement(n["a"].Button,{value:"c"},Object(y["formatMessage"])({id:"extra.dataExplore"})))),w={a:u.a.createElement(N,null),b:u.a.createElement(h["default"],{datasetName:t}),c:u.a.createElement(_["default"],{datasetNameFromParam:t,isTemporary:!0})},x=u.a.createElement(T,null);return u.a.createElement(l["a"],{initialValues:{n_rows:1e3}},u.a.createElement("div",{className:v.a.breadcrumb},u.a.createElement(o["a"],null,u.a.createElement(o["a"].Item,null,u.a.createElement("a",{href:"/"},Object(y["formatMessage"])({id:"extra.dataset"}))),u.a.createElement(o["a"].Item,null,Object(y["formatMessage"])({id:"extra.new"})),u.a.createElement(o["a"].Item,null,Object(y["formatMessage"])({id:"upload.uploadStep"})))),u.a.createElement(s["a"],{title:E,extra:x,style:{paddingBottom:60}},w[m]))};a["default"]=Object(i["o"])(Object(p["c"])(e=>{var a=e.uploadFile;return{uploadFile:a}})(D))}}]);