

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Application Design &mdash; Astutus 0.1.9rc2021.01.29.09.50 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme_overrides.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/app.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/astutus_dynamic_sphinx_pages.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Styled Flask Application Templates" href="templates.html" />
    <link rel="prev" title="Developer Notes from Before January 27, 2021" href="developer_notes_older.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Astutus
          

          
            
            <img src="../../_static/favicon.ico" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.9
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../app/index.html">Application</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../welcome.html">Welcome</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changes.html">Changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../roadmap_to_documentation.html">Roadmap to Documentation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="guidelines.html">Guidelines for Maintaining the System</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="packaging.html">Packaging</a></li>
<li class="toctree-l3"><a class="reference internal" href="documenting.html">Documenting</a></li>
<li class="toctree-l3"><a class="reference internal" href="developer_notes.html">Developer Notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="developer_notes_older.html">Developer Notes from Before January 27, 2021</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Application Design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#device-tree-ajax">Device Tree AJAX</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#page-loading">Page Loading</a></li>
<li class="toctree-l5"><a class="reference internal" href="#on-click-action">On Click Action</a></li>
<li class="toctree-l5"><a class="reference internal" href="#add-alias-form">Add Alias Form</a></li>
<li class="toctree-l5"><a class="reference internal" href="#general-page-functionality">General Page Functionality</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="templates.html">Styled Flask Application Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="readme.html">Astutus Readme</a></li>
<li class="toctree-l3"><a class="reference internal" href="macosx.html">Working with Macintosh OSX</a></li>
<li class="toctree-l3"><a class="reference internal" href="smakn_usb_relay.html">SMAKN LCUS-1 USB Relay</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../source/modules.html">API Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#indices-and-tables">Indices and tables</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Astutus</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Documentation</a> &raquo;</li>
        
          <li><a href="guidelines.html">Guidelines for Maintaining the System</a> &raquo;</li>
        
      <li>Application Design</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/doc/maintanence/design.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="application-design">
<h1>Application Design<a class="headerlink" href="#application-design" title="Permalink to this headline">¶</a></h1>
<div class="section" id="device-tree-ajax">
<h2>Device Tree AJAX<a class="headerlink" href="#device-tree-ajax" title="Permalink to this headline">¶</a></h2>
<p>The USB device tree is implemented mostly in HTML and Javascript using AJAX concepts.
Consequently, it is not easily explained using Python docstrings and Sphinx Apidoc
tactics.  Rather than including comments in the HTML and Javascript, which has
performance implications, the design of this part of the system will be shared here.</p>
<div class="section" id="page-loading">
<h3>Page Loading<a class="headerlink" href="#page-loading" title="Permalink to this headline">¶</a></h3>
<p>The HTML page loads quickly - about a tenth of a secon, with no functionality, with only
data that has been gathered during the process of identifying the tree, and consequently,
not the final look. Near the bottom of the page, the update process is triggered with this code:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">updateAllDescriptions</span><span class="p">();</span>
</pre></div>
</div>
<p>This function call triggers the process of updating all of the descriptions and fetching
such information as needed to use the page.  The update proceeds from the top of the page
down to the bottom, so that the part of the browser page that is immediately visible is
updated first, in perhaps half a second.</p>
<p>The function that actually updates the description for a particular button is:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">updateButtonData</span><span class="p">(</span><span class="nx">buttons</span><span class="p">[</span><span class="nx">buttonIdx</span><span class="p">]);</span>
</pre></div>
</div>
<p>The updateButtonData function initiates an asynchronous HTTP call to the Flask web application,
and then returns.  The callback triggered when the web server responds processes the response
which contains the information required so that the next button’s update can be triggered.
In addition, the remained of the information necessary for updating the button’s description
is obtained by calling:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">updateNodeData</span><span class="p">(</span><span class="nx">button</span><span class="p">,</span> <span class="nx">data_for_dir</span><span class="p">);</span>
</pre></div>
</div>
<p>The updateNodeData function call makes another asynchronous HTTP call to the Flask web application
to collect the remained of the needed information.  In the callback triggered when the web
server responds provides the remainder of the information for updating the labels associated
with each USB device and attaches an onclick handler to each button associate with every device.</p>
<p>The information returned by the asynchonous HTTP calls is stored in HTML5 data attributes.</p>
<p>The asynchronous HTTP calls are implemented using vanilla Javascript calls, rather than
by using JQuery.</p>
</div>
<div class="section" id="on-click-action">
<h3>On Click Action<a class="headerlink" href="#on-click-action" title="Permalink to this headline">¶</a></h3>
<p>When a button is clicked, a popup is displayed on the web page.</p>
<p>Currently the popup directly displays the Add Alias form, since that was the first command implemented.</p>
<p>In the future, the popup will display a menu, and other forms will popup upon selection of the form.</p>
</div>
<div class="section" id="add-alias-form">
<h3>Add Alias Form<a class="headerlink" href="#add-alias-form" title="Permalink to this headline">¶</a></h3>
<p>The following functions are associated with the Add Alias form:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">handleAliasAddForm</span><span class="p">()</span>

<span class="kd">function</span> <span class="nx">handleAddAliasFormCancel</span><span class="p">()</span>

<span class="kd">function</span> <span class="nx">updatePlaceholderTable</span><span class="p">(</span><span class="nx">table_id</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span>

<span class="kd">function</span> <span class="nx">rememberTemplateSelection</span><span class="p">(</span> <span class="nx">selectionStart</span><span class="p">,</span> <span class="nx">selectionEnd</span><span class="p">)</span>

<span class="kd">function</span> <span class="nx">handleInsertButtonClick</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span>

<span class="kd">function</span> <span class="nx">onTreeButtonClick</span><span class="p">(</span><span class="nx">button</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="general-page-functionality">
<h3>General Page Functionality<a class="headerlink" href="#general-page-functionality" title="Permalink to this headline">¶</a></h3>
<p>The following functions are used for the overall page functionality:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">isElementInViewport</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span>

<span class="kd">function</span> <span class="nx">toggleVisibility</span><span class="p">(</span><span class="nx">checkbox</span><span class="p">,</span> <span class="nx">cssClass</span><span class="p">,</span> <span class="nx">displayValue</span><span class="p">)</span>

<span class="kd">function</span> <span class="nx">onBackgroundColorChange</span><span class="p">(</span><span class="nx">colorInput</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="templates.html" class="btn btn-neutral float-right" title="Styled Flask Application Templates" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="developer_notes_older.html" class="btn btn-neutral float-left" title="Developer Notes from Before January 27, 2021" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Rich Dobbs.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>