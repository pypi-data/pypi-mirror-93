

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Mathematical background &mdash; Group Lasso 1.4.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="_static/gallery-rendered-html.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="api_reference.html" />
    <link rel="prev" title="GroupLasso for linear regression with dummy variables" href="auto_examples/example_sparse_group_lasso.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Group Lasso
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/index.html">Examples</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Mathematical background</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#quick-overview">Quick overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#details-on-fista">Details on FISTA</a></li>
<li class="toctree-l2"><a class="reference internal" href="#computing-the-lipschitz-coefficients">Computing the Lipschitz coefficients</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api_reference.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Group Lasso</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Mathematical background</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/maths.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mathematical-background">
<h1>Mathematical background<a class="headerlink" href="#mathematical-background" title="Permalink to this headline">¶</a></h1>
<div class="section" id="quick-overview">
<h2>Quick overview<a class="headerlink" href="#quick-overview" title="Permalink to this headline">¶</a></h2>
<p>Let us recap the definition of a sparse group lasso regularised machine
learning algorithm. Consider the unregularised loss function
<span class="math notranslate nohighlight">\(L(\mathbf{\beta}; \mathbf{X}, \mathbf{y})\)</span>, where
<span class="math notranslate nohighlight">\(\mathbf{\beta}\)</span> is the model coefficients, <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> is the
data matrix and <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> is the target vector (or matrix in the
case of multiple regression/classification algorithms). Furthermore, we
assume that
<span class="math notranslate nohighlight">\(\mathbf{\beta} = \left[\mathbf{\beta}_1^T, ..., \mathbf{\beta}_G^T\right]^T\)</span>
and that <span class="math notranslate nohighlight">\(\mathbf{X} = \left[\mathbf{X}_1^T, ..., \mathbf{X}_G^T\right]^T\)</span>,
where <span class="math notranslate nohighlight">\(\mathbf{\beta}_g\)</span> and <span class="math notranslate nohighlight">\(\mathbf{X}_g\)</span> is the coefficients
and data matrices corresponding to covariate group <span class="math notranslate nohighlight">\(g\)</span>. In this case, we
define the group lasso regularised loss function as</p>
<div class="math notranslate nohighlight">
\[L(\mathbf{\beta}; \mathbf{X}, \mathbf{y})
 + \lambda_1 ||\mathbf{\beta}||_1
 + \lambda_2 \sum_{g \in \mathcal{G}} \sqrt{d_g} ||\mathbf{\beta}||_2\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda_1\)</span> is the parameter-wise regularisation penalty,
<span class="math notranslate nohighlight">\(\lambda_2\)</span> is the group-wise regularisation penalty,
<span class="math notranslate nohighlight">\(\mathbf{\beta}_g \in \mathbf{d_g}\)</span> and
<span class="math notranslate nohighlight">\(\mathcal{G}\)</span> is the set of all groups.</p>
<p>The above regularisation penalty is nice in the sense that it promotes that a
sparse set of groups are chosen for the regularisation coefficients <a class="footnote-reference brackets" href="#id7" id="id1">1</a>.
However, the non-continuous derivative makes the optimisation procedure much
more complicated than with say a Ridge penalty (i.e. squared 2-norm penalty).
One common algorithm used to solve this optimisation problem is
<em>group coordinate descent</em>, in which the optimisation problem is solved for
each group separately, in an alternating fashion. However, I decided to use
the fast iterative soft thresholding (FISTA) algorithm <a class="footnote-reference brackets" href="#id8" id="id2">2</a> with the
gradient-based restarting scheme given in <a class="footnote-reference brackets" href="#id9" id="id3">3</a>. This is regarded as one of the
best algorithms to solve optimisation problems on the form</p>
<div class="math notranslate nohighlight">
\[\text{arg} \min_{\mathbf{\beta}} L(\mathbf{\beta}) + R(\mathbf{\beta}),\]</div>
<p>where <span class="math notranslate nohighlight">\(L\)</span> is a convex, differentiable function with Lipschitz continuous
gradient and <span class="math notranslate nohighlight">\(R\)</span> is a convex lower semicontinouous function.</p>
</div>
<div class="section" id="details-on-fista">
<h2>Details on FISTA<a class="headerlink" href="#details-on-fista" title="Permalink to this headline">¶</a></h2>
<p>There are three essential parts of having an efficient implementation of the
FISTA algorithm. First and foremost, we need an efficient way to compute the
gradient of the loss function. Next, and just as important, we need to be able
to compute the <em>proximal map</em> of the regulariser efficiently. That is, we need
to know how to compute</p>
<div class="math notranslate nohighlight">
\[prox(\mathbf{\beta}) = \text{arg} \min_{\hat{\mathbf{\beta}}}
R(\hat{\mathbf{\beta}}) + \frac{1}{2}||\hat{\mathbf{\beta}} - \mathbf{\beta}||_2^2\]</div>
<p>efficiently. To compute the proximal map for the sparse group lasso regulariser,
we use the following identity from <a class="footnote-reference brackets" href="#id10" id="id4">4</a>:</p>
<div class="math notranslate nohighlight">
\[prox_{\lambda_1 ||\mathbf{\cdot}||_1 + \lambda_2 \sum_g w_g ||\mathbf{\cdot}||}(\mathbf{\beta})
= prox_{\lambda_2 \sum_g w_g ||\mathbf{\cdot}||}(prox_{\lambda_1 ||\mathbf{\cdot}||_1}(\mathbf{\beta}),\]</div>
<p>where <span class="math notranslate nohighlight">\(prox_{\lambda_1 ||\mathbf{\cdot}||_1 + \lambda_2 \sum_g w_g ||\mathbf{\cdot}||}\)</span>
is the proximal map for the sparse group lasso regulariser,
<span class="math notranslate nohighlight">\(prox_{\lambda_2 \sum_g w_g ||\mathbf{\cdot}||}\)</span> is the proximal map
for the group lasso regulariser and
<span class="math notranslate nohighlight">\(prox_{\lambda_1 ||\mathbf{\cdot}||_1\)</span> is the proximal map for the
lasso regulariser. For more information on the proximal map, see <a class="footnote-reference brackets" href="#id11" id="id5">5</a> or <a class="footnote-reference brackets" href="#id12" id="id6">6</a>.
Finally, we need a Lipschitz bound for the gradient of the loss function, since
this is used to compute the step-length of the optimisation procedure. Luckily,
this can also be estimated using a line-search.</p>
<p>Unfortunately, the FISTA algorithm is not stable in the mini-batch case, making
it inefficient for extremely large datasets. However, in my experiments, I have
found that it still recovers the correct sparsity patterns in the data when used
in a mini-batch fashion for the group lasso problem. At least so long as the
mini-batches are relatively large.</p>
</div>
<div class="section" id="computing-the-lipschitz-coefficients">
<h2>Computing the Lipschitz coefficients<a class="headerlink" href="#computing-the-lipschitz-coefficients" title="Permalink to this headline">¶</a></h2>
<p>The Lipschitz coefficient of the gradient to the sum-of-squares loss is given
by <span class="math notranslate nohighlight">\(\sigma_1^2\)</span>, where <span class="math notranslate nohighlight">\(\sigma_1\)</span> is the largest singular value
of the data matrix.</p>
<p>I have not found a published expression for the Lipschitz coefficient of the
sigmoid cross-entropy loss. Therefore, I derived the following bound:</p>
<div class="math notranslate nohighlight">
\[L = \sqrt{12} ||\mathbf{X}||_F,\]</div>
<p>where <span class="math notranslate nohighlight">\(||\mathbf{\cdot}||_F = \sqrt{\sum_{i, j} \mathbf{X}_{i, j}^2}\)</span> is
the Frobenius norm. The next step to get group lasso regularised logistic
regression is deriving the Lipschitz bound for the gradient of the softmax
cross-entropy loss.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id7"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Yuan M, Lin Y. Model selection and estimation in regression with
grouped variables. Journal of the Royal Statistical Society: Series B
(Statistical Methodology). 2006 Feb;68(1):49-67.</p>
</dd>
<dt class="label" id="id8"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Beck A, Teboulle M. A fast iterative shrinkage-thresholding algorithm
for linear inverse problems. SIAM journal on imaging sciences.
2009 Mar 4;2(1):183-202.</p>
</dd>
<dt class="label" id="id9"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>O’Donoghue B, Candes E. Adaptive restart for accelerated gradient
schemes. Foundations of computational mathematics.
2015 Jun 1;15(3):715-32.</p>
</dd>
<dt class="label" id="id10"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>Yuan L, Liu J, Ye J. (2011), Efficient methods for overlapping group
lasso. Advances in Neural Information Processing Systems (pp. 352-360).</p>
</dd>
<dt class="label" id="id11"><span class="brackets"><a class="fn-backref" href="#id5">5</a></span></dt>
<dd><p>Parikh, N., &amp; Boyd, S. (2014). Proximal algorithms. Foundations and
Trends in Optimization, 1(3), 127-239.</p>
</dd>
<dt class="label" id="id12"><span class="brackets"><a class="fn-backref" href="#id6">6</a></span></dt>
<dd><p>Beck, A. (2017). First-order methods in optimization (Vol. 25). SIAM.</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="api_reference.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="auto_examples/example_sparse_group_lasso.html" class="btn btn-neutral float-left" title="GroupLasso for linear regression with dummy variables" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2019, Yngve Mardal Moe.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>