var cover=function(t){function e(a){if(n[a])return n[a].exports;var i=n[a]={i:a,l:!1,exports:{}};return t[a].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,a){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:a})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="++resource++collective.cover/",e(e.s=1)}([function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=function(){function t(e){a(this,t),this.$tile=$(e),this.$tile.hasClass("tile-content")||(this.$tile=$(".tile-content",this.$tile)),this.initGalleria()}return i(t,[{key:"initGalleria",value:function(){Galleria.loadTheme("++resource++collective.cover/galleria/theme.js"),Galleria.run(this.$tile);var t={height:parseFloat(this.$tile.attr("data-image-ratio"))};$("body").hasClass("template-view")&&(t.autoplay="True"===this.$tile.attr("data-autoplay")),Galleria.configure(t)}}]),t}();e.default=o},function(t,e,n){n(2),n(3),n(4),n(5),n(6),n(7),n(8),n(9),n(10),n(11),n(12),n(13),n(14),n(15),n(16),t.exports=n(17)},function(t,e,n){t.exports=n.p+"img/dot.png"},function(t,e,n){t.exports=n.p+"img/frontpage_icon.png"},function(t,e,n){t.exports=n.p+"img/tile-banner.png"},function(t,e,n){t.exports=n.p+"img/tile-basic.png"},function(t,e,n){t.exports=n.p+"img/tile-calendar.png"},function(t,e,n){t.exports=n.p+"img/tile-carousel.png"},function(t,e,n){t.exports=n.p+"img/tile-collection.png"},function(t,e,n){t.exports=n.p+"img/tile-contentbody.png"},function(t,e,n){t.exports=n.p+"img/tile-embed.png"},function(t,e,n){t.exports=n.p+"img/tile-file.png"},function(t,e,n){t.exports=n.p+"img/tile-generic.png"},function(t,e,n){t.exports=n.p+"img/tile-list.png"},function(t,e,n){t.exports=n.p+"img/tile-pfg.png"},function(t,e,n){t.exports=n.p+"img/tile-richtext.png"},function(t,e){},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(18),o=a(i),r=n(19),s=a(r),l=n(21),c=a(l),u=n(24),d=a(u),h=n(0),f=a(h);jQuery.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator],$(function(){var t=$(".template-collective-cover-content #form-widgets-template_layout");void 0!==t[0]&&new o.default(t),void 0!==$(".portaltype-collective-cover-content.template-compose")[0]&&new s.default,void 0!==$(".portaltype-collective-cover-content.template-layoutedit")[0]&&new c.default;var e=!0,n=!1,a=void 0;try{for(var i,r=$(".cover-carousel-tile")[Symbol.iterator]();!(e=(i=r.next()).done);e=!0){var l=i.value;new f.default(l)}}catch(t){n=!0,a=t}finally{try{!e&&r.return&&r.return()}finally{if(n)throw a}}$(".tile[data-tile-type=collective\\.cover\\.carousel]").on("change",function(){new f.default(this)}),void 0!==$(".cover-calendar-tile")[0]&&new d.default}),e.default={ComposeView:s.default,AddView:o.default,LayoutView:c.default,CalendarTile:d.default,CarouselTile:f.default}},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=function(){function t(e){a(this,t);var n=e,i=n.data("layouts"),o=$("#layout-preview"),r=$("#canvas-layout")[0].getContext("2d");this.setup_preview(o,n,r,i),n.change(function(t,e){this.setup_preview(o,$(this),r,i)})}return i(t,[{key:"draw_preview",value:function(t,e){var n=10;$(t).each(function(){e.fillStyle="#EEEEEE",e.fillRect(0,n,300,70);var t=10;this.children.length;$(this.children).each(function(){var a=18.125*this.size-10;e.fillStyle="#D9D9D9",e.fillRect(t,n+10,a,50),t=t+a+10}),n+=80})}},{key:"setup_preview",value:function(t,e,n,a){var i=e.find(":selected").val();$("#canvas-layout")[0].width=$("#canvas-layout")[0].width,$("#canvas-layout")[0].height=80*a[i].length>300?80*a[i].length:300,this.draw_preview(a[i],n),t.find("h3").html(i)}}]),t}();e.default=o},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(20),r=function(t){return t&&t.__esModule?t:{default:t}}(o),s=function(){function t(){a(this,t),this.bindEvents(),this.update(),this.prepareRichText(),new r.default(this),"undefined"!=typeof plone&&$(window).unload(plone.UnlockHandler.execute)}return i(t,[{key:"bindEvents",value:function(){$(document).on("mouseover",".sortable-tile",this.onMouseOverSortable.bind(this))}},{key:"update",value:function(){$("#content .tile").each(function(){void 0===$(this).find(".loading-mask")[0]&&$(this).append('<div class="loading-mask"/>')}),this.removeObjFromTile()}},{key:"removeObjFromTile",value:function(){$(".tile-remove-item").remove(),$(".sortable-tile").each(function(){$(this).children("*[data-content-uuid]").append('<i class="tile-remove-item"><span class="text">remove</span></i>')}),$(".tile-remove-item").unbind("click"),$(".tile-remove-item").on("click",this.onRemoveClick.bind(this))}},{key:"editSortable",value:function(){var t=$('div[data-carousel="carousel-sort"]');if(void 0!==t[0]){var e=function(t,e){t.empty(),e.find("[data-content-uuid]").each(function(e){t.append($(this).attr("data-content-uuid")+"\n")})},n=t.find(">textarea"),a=t.find(".sortable");n.hide(),a.sortable({stop:function(t,i){e(n,a)}}),a.find("[data-content-uuid]").append("<i class='tile-remove-item' data-content-uuid=''><span class='text'>remove</span></i>"),a.find("[data-content-uuid]").find(".tile-remove-item").click(function(t){$(this).parent(".textline-sortable-element").remove(),e(n,a)})}}},{key:"prepareRichText",value:function(){var t=this;void 0!==$.fn.prepOverlay?$("a.edit-tile-link").prepOverlay({subtype:"ajax",filter:".tile-content",formselector:"#edit_tile",closeselector:'[name="buttons.cancel"]',noform:"close",beforepost:function(t,e){var n=jQuery("#edit_tile iframe"),a={};n.each(function(t){var e=$(this),n=e.attr("id"),i=n.length;i>4&&"_ifr"==n.slice(i-4,i)&&(a[n.slice(0,-4)]=e)});$.map(e,function(t,n){return"textarea"==e[n].type&&void 0!==a[e[n].name]&&(t.value=a[t.name].contents().find("body").html()),t})},afterpost:function(t,e){var n=e.data("pbo").src.split("/").pop(),a=$("#"+n);a.html(t.children()),a.trigger("change")},config:{onLoad:function(){"undefined"!=typeof __non_webpack_require&&__non_webpack_require.defined("pat-registry")?("undefined"!=typeof tinyMCE&&null!==tinyMCE&&null!=tinyMCE.EditorManager&&(tinyMCE.EditorManager.editors=[]),$(".overlay textarea.mce_editable").addClass("pat-tinymce"),__non_webpack_require("pat-registry").scan($(".overlay"),["tinymce"]),$(".overlay input#buttons-save").on("click",function(){tinyMCE.triggerSave()}),$(".overlay").on("mouseover",function(){$("div.plone-modal-wrapper").css("z-index","10050")})):"undefined"!=typeof initTinyMCE&&("undefined"!=typeof tinyMCE&&null!==tinyMCE&&null!=tinyMCE.EditorManager&&(tinyMCE.EditorManager.editors=[]),initTinyMCE(this.getOverlay())),$("div.suppressVisualEditor").remove(),t.editSortable()}}}):$("a.edit-tile-link").on("show.plone-modal.patterns",t.editSortable)}},{key:"onMouseOverSortable",value:function(t){var e=$(t.currentTarget);if(!e.data("init")){var n=function(t,n){var a=[];e.children().each(function(t){var n=$(e.children()[t]);void 0!==n.attr("data-content-uuid")&&a.push(n.attr("data-content-uuid"))});var i=e.closest(".tile"),o=i.attr("data-tile-type"),r=i.attr("id");$.ajax({url:"@@updatelisttilecontent",context:this,data:{"tile-type":o,"tile-id":r,uuids:a},success:function(t){return i.html(t),i.trigger("change"),this.update(),!1},error:function(t,e,n){return i.html(e+": "+n),this.update(),!1}})};e.data("init",!0).sortable({stop:n.bind(this)})}}},{key:"onRemoveClick",value:function(t){t.preventDefault();var e=$(t.currentTarget).parent(),n=e.attr("data-content-uuid"),a=e.parents(".tile");a.find(".loading-mask").addClass("show remove-tile");var i=a.attr("data-tile-type"),o=a.attr("id");$.ajax({url:"@@removeitemfromlisttile",context:this,data:{"tile-type":i,"tile-id":o,uuid:n},success:function(t){return a.html(t),a.trigger("change"),this.update(),a.find(".loading-mask").removeClass("show remove-tile"),!1},error:function(t,e,n){return a.html(e+": "+n),this.update(),a.find(".loading-mask").removeClass("show remove-tile"),!1}})}}]),t}();e.default=s},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=n(0),r=function(t){return t&&t.__esModule?t:{default:t}}(o),s=function(){function t(e){if(a(this,t),this.parent=e,this.ajaxSearchRequest=[],this.timeoutIDs=[],this.portal_url=window.portal_url,null==this.portal_url&&(this.portal_url=$("body").attr("data-portal-url")),this.timeout=500,this.call_context=this.portal_url+"/",this.current_path=document.location.href,this.current_path.indexOf("/compose")>0&&this.getFolderContents(this.call_context,"@@jsonbytype"),$("#contentchooser-content-search").length){var n=$("#contentchooser-content-search-compose-button").text();$("#content").prepend('<div class="btn" id="contentchooser-content-show-button">'+n+"</div>"),$("#contentchooser-content-search").resizable({maxHeight:411,minHeight:411,minWidth:350,maxWidth:540})}var i=this;this.contentchooserMaker({draggable:"#contentchooser-content-search .item-list li,\n                  .template-compose #content .tile,\n                  .template-compose #content .tile-move,\n                  .template-compose [data-tile-type=collective\\.cover\\.carousel] [data-content-uuid]",draggable_acepted:function(t){var e=$(this),n=e.data("tileValidCt"),a=$.inArray(t.attr("data-content-type"),n)>=0,i="True"===e.attr("data-is-droppable"),o=t.attr("id");t.is("[data-tile-id]")&&(o=t.attr("data-tile-id"));var r="True"===t.attr("data-has-subitem"),s=t.attr("data-content-uuid");return!!(!n&&r||t.attr("data-tile-type")===e.attr("data-tile-type")&&(void 0!==s||t.hasClass("tile-move"))&&o!==e.attr("id"))||!(!i||o===e.attr("id")||void 0===s)&&a},windowId:"#contentchooser-content-search",droppable:".template-compose #content .tile",dropped:function(t,e){var n=e.draggable,a=$(this),o=a.attr("data-tile-type"),s=a.attr("id"),l="True"===a.attr("data-has_subitem"),c=n.attr("id");n.is("[data-tile-id]")&&(c=n.attr("data-tile-id"));var u=$("#"+c),d=u.attr("data-tile-type"),h="True"===u.attr("data-has-subitem"),f=n.attr("data-content-uuid"),p=n.attr("data-content-type");if(s===c)return!1;if(a.find(".loading-mask").addClass("show"),n.hasClass("tile")||h){var v=function t(){return $("#"+c+" [data-content-uuid="+f+"]").length>0?$.ajax({url:"@@removeitemfromlisttile",data:{"tile-type":d,"tile-id":c,uuid:f},success:function(e){return u.html(e),u.find(".loading-mask").addClass("show"),h||(u.removeAttr("data-content-uuid"),u.removeAttr("data-content-type")),t(),!1}}):(u.find(".loading-mask").removeClass("show"),a.find(".loading-mask").removeClass("show"),i.parent.update()),!1};u.find(".loading-mask").addClass("show"),$.ajax({url:"@@movetilecontent",data:{"origin-type":d,"origin-id":c,"target-type":o,"target-id":s,uuid:f},success:function(t){return a.html(t),a.find(".loading-mask").addClass("show"),l||(a.attr("data-content-uuid",f),a.attr("data-content-type",p)),$.ajax({url:"@@updatetile",data:{"tile-id":c},success:function(t){return u.html(t),u.find(".loading-mask").addClass("show"),h||(u.removeAttr("data-content-uuid"),u.removeAttr("data-content-type")),v(),"collective.cover.carousel"===a.attr("data-tile-type")&&new r.default(a),!1},error:function(t,e,n){return u.html(e+": "+n),u.find(".loading-mask").removeClass("show"),!1}}),!1},error:function(t,e,n){return a.html(e+": "+n),a.find(".loading-mask").removeClass("show"),!1}})}else $.ajax({url:"@@updatetilecontent",data:{"tile-type":o,"tile-id":s,uuid:f},success:function(t){return a.html(t),l||(a.attr("data-content-uuid",f),a.attr("data-content-type",p)),a.find(".loading-mask").removeClass("show"),i.parent.update(),"collective.cover.carousel"===a.attr("data-tile-type")&&new r.default(a),!1},error:function(t,e,n){return a.html(e+": "+n),a.find(".loading-mask").removeClass("show"),i.parent.update(),!1}})}}),this.bindEvents()}return i(t,[{key:"bindEvents",value:function(){$("#contentchooser-content-search #content-trees .item-list").on("scroll",this.onTreeScroll.bind(this)),this.filterOnKeyUp(),$("#contentchooser-content-search #recent .item-list").on("scroll",this.onRecentScroll.bind(this)),$(document).on("click","#recent .contentchooser-clear",function(t){$(t.currentTarget).prev().children("input").val("");var e=$("#contentchooser-content-search-button").attr("data-url");return this.ajaxSearchRequest.push($.ajax({url:e,success:function(t){return $("#contentchooser-content-search #recent .item-list").html(t),$("#recent .filter-count").text(""),!1}})),!1}),$(document).on("click","#content-trees .contentchooser-clear",function(t){return $(t.currentTarget).prev().children("input").val(""),this.getFolderContents(portal_url,"@@jsonbytype"),!1}),$("#contentchooser-content-search-button").click(function(t){return t.preventDefault(),t.stopPropagation(),this.contentSearchFilter(),!1}.bind(this)),$("#contentchooser-content-search").draggable({start:function(t,e){$(this).removeClass("right")},cancel:".item-list, #contentchooser-content-search-input, #contentchooser-content-trees"}),$("#contentchooser-content-show-button").click(function(){var t=$(this).offset();$("#contentchooser-content-search").css("display","block"),$("#contentchooser-content-search").offset({top:t.top})}),$("#contentchooser-content-search .close").click(function(t){t.preventDefault(),$("#contentchooser-content-search").css("display","none")}),$(document).on("click","#contentchooser-content-search #content-tree .item-list li",function(t){t.stopPropagation();var e=$(this).children("ul");e.is(":visible")?e.css("display","none"):e.css("display","block")})}},{key:"onTreeScroll",value:function(t){var e=$(t.currentTarget),n=e.attr("data-last-path");"false"===e.attr("data-has-next")||e.scrollTop()+e.innerHeight()<e[0].scrollHeight||this.getFolderContents(n,"@@jsonbytype",!0)}},{key:"onRecentScroll",value:function(t){var e=$(t.currentTarget),n=parseInt(e.attr("data-total-results"),10);if(!("False"===e.attr("data-has-next")||e.scrollTop()+e.innerHeight()<e[0].scrollHeight||$("li",e).length>=n)){var a=$("#contentchooser-content-search-button").attr("data-url"),i=$("#contentchooser-content-search-input").val(),o=parseInt(e.attr("data-nextpage"),10),r={q:i,page:o};$("#ajax-spinner").show(),this.ajaxSearchRequest.push($.ajax({url:a,data:r,success:function(t){$("#ajax-spinner").hide();var n=$(t)[1];return e.attr("data-has-next",$(n).attr("data-has-next")),e.attr("data-nextpage",$(n).attr("data-nextpage")),e.append(n.children),!1}}))}}},{key:"send",value:function(t){function e(t){n=0;try{n=new ActiveXObject(t)}catch(t){}return n}var n=void 0,a=window,i=0;if(t.scope=t.scope||this,t.success_scope=t.success_scope||t.scope,t.error_scope=t.error_scope||t.scope,t.async=!1!==t.async,t.data=t.data||"",n=a.XMLHttpRequest?new XMLHttpRequest:e("Microsoft.XMLHTTP")||e("Msxml2.XMLHTTP")){n.overrideMimeType&&n.overrideMimeType(t.content_type),n.open(t.type||(t.data?"POST":"GET"),t.url,t.async),t.content_type&&n.setRequestHeader("Content-Type",t.content_type),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.send(t.data);var o=function e(){!t.async||4==n.readyState||i++>1e4?(t.success&&i<1e4&&200==n.status?t.success.call(t.success_scope,""+n.responseText,n,t):t.error&&t.error.call(t.error_scope,i>1e4?"TIMED_OUT":"GENERAL",n,t),n=null):a.setTimeout(e,10)};if(!t.async)return o();a.setTimeout(o,10)}}},{key:"getAbsolutePath",value:function(){var t=window.location,e=t.pathname.substring(0,t.pathname.lastIndexOf("/")+1);return t.href.substring(0,t.href.length-((t.pathname+t.search+t.hash).length-e.length))}},{key:"getFolderContents",value:function(t,e,n){null===n&&(n=!1);var a=document,i=(window,navigator),o=(i.userAgent,$("#content-trees .item-list")),r=o.attr("data-last-path");o.attr("data-last-path",t);var s=o.attr("data-has-next"),l=parseInt(o.attr("data-nextpage"),10);t!==r&&$("input:text[id=contentchooser-content-trees][name=contentchooser-content-trees]").val(""),void 0===t&&(t=this.call_context);var c="searchtext="+($("input:text[id=contentchooser-content-trees][name=contentchooser-content-trees]").val()||"")+'&rooted="False"&document_base_url='+encodeURIComponent(a.baseURI);null!==s&&"true"===s&&!0===n&&(c="page="+l+"&"+c),$("#ajax-spinner").show(),this.send({url:t+"/"+e,content_type:"application/x-www-form-urlencoded",type:"POST",data:c,success:function(t){$("#ajax-spinner").hide();var e="",n=$.parseJSON(t);if(""!==$("input:text[id=contentchooser-content-trees][name=contentchooser-content-trees]").val()?$("#content-trees .filter-count").text(" "+n.total_results+" Results"):$("#content-trees .filter-count").text(""),o.attr("data-has-next",n.has_next),o.attr("data-nextpage",n.nextpage),n.items.length>0)for(var a=0;a<n.items.length;a++)e+='<li data-is-folderish="'+n.items[a].is_folderish+'" data-content-type="'+n.items[a].portal_type+'" data-content-uuid="'+n.items[a].uuid+'" class="ui-draggable">',n.items[a].is_folderish?(n.items[a].icon.length&&(e+='<img src="'+n.items[a].icon+'" /> '),e+='<a class="'+n.items[a].classicon+" "+n.items[a].r_state+'" ',e+='title="'+n.items[a].description+'" ',e+='href="'+n.items[a].url+'">',e+="<span>"+n.items[a].title+"</span>",e+="</a>"):("Image"==n.items[a].portal_type&&(e+='<img src="'+this.call_context+'/image.png" border="0"/> '),e+='<a data-ct-type="'+n.items[a].portal_type+'" class="'+n.items[a].classicon+" "+n.items[a].r_state+'" title="'+n.items[a].description+'"> ',e+="<span>"+n.items[a].title+"</span>",e+="</a>"),e+="</li>";else e="";2===n.nextpage?$("#content-trees > .item-list")[0].innerHTML=e:$("#content-trees > .item-list")[0].innerHTML+=e;var i=function(t){t.preventDefault();var e=$(t.currentTarget);this.getFolderContents(e.attr("href"),"@@jsonbytype")};$('#content-trees > .item-list > li[data-is-folderish="true"] > a').on("click",i.bind(this)),e="";for(var r=0;r<n.path.length;r++)0!==r&&(e+=" &rarr; "),r==n.path.length-1?e+=n.path[r].title:(e+='<a href="'+n.path[r].url+'">',e+=n.path[r].title,e+="</a>");$("#content-trees #internalpath")[0].innerHTML=e,$("#content-trees #internalpath > a").on("click",i.bind(this))}})}},{key:"getCurrentFolderContents",value:function(){this.getFolderContents(this.current_path,"@@jsonbytype")}},{key:"filterOnKeyUp",value:function(){var t=[];$("#contentchooser-content-search-button").css("display","none"),$("#contentchooser-content-trees").keyup(function(e){var n=$(e.currentTarget).val();if(n.length>0&&n.length<3)return!1;var a=void 0,i=void 0,o=void 0;for(a=0,i=t.length;a<i;a++)o=t[a],clearTimeout(o);t=[],$("#ajax-spinner").hide();var r=setTimeout(function(){var t=$("#content-trees .item-list"),e=t.attr("data-last-path");this.getFolderContents(e,"@@jsonbytype")}.bind(this),this.timeout);t.push(r)}.bind(this)),$("#contentchooser-content-search-input").keyup(function(){$("#contentchooser-content-search-button").trigger("click")})}},{key:"contentSearchFilter",value:function(t){null===t&&(t=1);var e=$("#contentchooser-content-search-button").attr("data-url"),n=$("#contentchooser-content-search-input").val();if(n.length>0&&n.length<3)return!1;var a=void 0,i=void 0,o=void 0;for(a=0,i=this.timeoutIDs.length;a<i;a++)o=this.timeoutIDs[a],clearTimeout(o);this.timeoutIDs=[],$("#ajax-spinner").hide();var r=setTimeout(function(){var a={q:n,page:t};$("#ajax-spinner").show(),this.ajaxSearchRequest.push($.ajax({url:e,data:a,context:this,success:function(t){if($("#ajax-spinner").hide(),$("#contentchooser-content-search #recent .item-list").off("scroll"),$("#contentchooser-content-search #recent .item-list").replaceWith(t),$("#contentchooser-content-search #recent .item-list").on("scroll",this.onRecentScroll.bind(this)),""===n)$("#recent .filter-count").text("");else{var e=$("#contentchooser-content-search #recent .item-list"),a=e.attr("data-total-results");$("#recent .filter-count").text(" "+a+" Results")}return!1}}))}.bind(this),this.timeout);return this.timeoutIDs.push(r),!1}},{key:"onMouseOverDraggable",value:function(t){var e=$(t.currentTarget);e.data("init")||e.data("init",!0).draggable({scroll:!1,helper:"clone"})}},{key:"contentchooserMaker",value:function(t){var e=t.windowId,n=t.droppable,a=t.draggable,i="True"===$(e).attr("data-is-plone-5");$(document).on("mouseover",a,this.onMouseOverDraggable.bind(this)),$(n).droppable({activeClass:"ui-state-default",accept:t.draggable_acepted,hoverClass:"content-drop-hover ui-state-hover",drop:t.dropped}),!1===i&&$(".template-compose").length>0&&($(e+" .tab-pane").css("border",0),$(e+" legend").remove(),$(e+" ul.formTabs").tabs(e+" .tab-pane"))}}]),t}();e.default=s},function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),r=n(22),s=a(r),l=n(23),c=a(l),u=function(){function t(){i(this,t),this.$le=$(".layout"),this.conf=this.$le.data("layoutmanager-settings"),this.n_columns=this.conf.ncolumns,this.row_class="cover-row",this.row_dom=$('<div class="'+this.row_class+'">\n        <a href="#" class="config-row-link">\n          <i class="config-icon"></i>\n        </a>\n      </div>'),this.column_class="cover-column",this.column_dom=$('<div class="'+this.column_class+'">\n        <a href="#" class="config-column-link">\n          <i class="config-icon"></i>\n        </a>\n      </div>'),this.tile_class="cover-tile",this.tile_dom=$('<div class="'+this.tile_class+'"></div>'),this.bindEvents(),this.init(),"undefined"!=typeof plone&&$(window).unload(plone.UnlockHandler.execute)}return o(t,[{key:"onBeforeUnload",value:function(t){var e=window.form_modified_message||"Discard changes? If you click OK, any changes you have made will be lost.";if($("#btn-save").hasClass("modified"))return t.returnValue=e,e}},{key:"bindEvents",value:function(){var t=!1;$(document).scroll(function(){$(this).scrollTop()>200?t||(t=!0,$("#sidebar").addClass("fixed")):t&&(t=!1,$("#sidebar").removeClass("fixed"))});var e=$("#btn-save"),n=function(t){t.preventDefault();var n=this.html2json(this.$le);e.removeClass(function(t,e){return(e.match(/\bbtn-\S+/g)||[]).join(" ")}),e.find("span").text("Saving..."),$.ajax({url:"@@save_layout"+location.search,data:{cover_layout:JSON.stringify(n)},type:"POST",success:function(t){e.find("span").text("Saved"),$("#btn-save").removeClass("modified error"),$("#btn-save").addClass("saved btn-success"),$("#btn-export").removeClass("disabled")},error:function(t,n,a){e.find("span").text("Error "+a),$("#btn-save").addClass("error btn-danger")}})};e.on("click",n.bind(this))}},{key:"init",value:function(){this.setup(),this.row_events(),this.column_events(),this.$le.bind("modified.layout",this.layout_modified),window.onbeforeunload=this.onBeforeUnload}},{key:"setup",value:function(){$("#btn-row").draggable({connectToSortable:".layout",helper:"clone"}),$("#btn-column").draggable({appendTo:"body",helper:"clone"}),$(".btn-tile").draggable({appendTo:"body",helper:"clone"});var t=function(t,e){if(e.item.hasClass("btn")){var n=this.row_dom.clone();e.item.after(n),e.item.remove(),this.row_events(n),this.delete_manager(n),this.row_drop($(n))}this.$le.trigger("modified.layout")};this.$le.sortable({items:"."+this.row_class,placeholder:"ui-sortable-placeholder",stop:t.bind(this)}),this.generate_grid_css(),this.delete_manager(),this.resize_columns_manager(),this.class_chooser_manager(),this.tile_config_manager();var e=$("#btn-export");e.on("click",function(t){t.preventDefault(),!e.hasClass("disabled")&&$("#btn-save").hasClass("saved")&&$("#export-layout").modal()}),$("#btn-cancel-export-layout").on("click",function(t){t.preventDefault(),$("#export-layout").modal("hide")})}},{key:"get_random_value",value:function(t){var e=void 0;return e=window.crypto&&"function"==typeof window.crypto.getRandomValues?crypto.getRandomValues(new Uint8Array(1))[0]%16|0:16*Math.random()|0,e=(this.timestamp+e)%16|0,this.timestamp=Math.floor(this.timestamp/16),"x"!==t&&(e=3&e|8),e.toString(16)}},{key:"generate_uuid",value:function(){return this.timestamp=(new Date).getTime(),window.performance&&"function"==typeof window.performance.now&&(this.timestamp+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,this.get_random_value.bind(this))}},{key:"generate_tile_id",value:function(){for(var t=this.generate_uuid();$.isNumeric(t[0]);)t=this.generate_uuid();return t}},{key:"row_drop",value:function(t){var e=this.column_dom.clone();t.prepend(e),this.column_events(e),this.delete_manager(e),this.resize_columns_manager(e),this.calculate_grid(t.find("."+this.column_class)),this.$le.trigger("modified.layout")}},{key:"row_events",value:function(t){var e=t||this.$le.find("."+this.row_class),n=function(t,e){var n=this.row_dom.clone();n[0]=t.target,this.row_drop(n)};e.droppable({activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:"#btn-column",drop:n.bind(this)});var a=function(t,e){e.placeholder.attr("data-column-size",e.helper.data("column-size"))},i=function(t,e){this.$le.trigger("modified.layout")},o=function(t,n){n.sender[0]!=this&&(e.calculate_grid($(this).find("."+this.column_class)),e.calculate_grid(n.sender.find("."+this.column_class)))};e.sortable({items:"."+this.column_class,connectWith:"."+this.row_class,appendTo:".layout",helper:"clone",placeholder:"ui-sortable-placeholder-column",cancel:".resizer",start:a.bind(this),stop:i.bind(this),receive:o.bind(this)})}},{key:"column_events",value:function(t){var e=t||this.$le.find("."+this.column_class),n=function(t,n){var a=this.tile_dom.clone(),i=e,o=n.draggable.data("tile-type"),r=n.draggable.data("tile-configurable");a.attr("data-tile-type",o);var s=this.generate_tile_id();a.attr("id",s);var l="@@configure-tile/"+o+"/"+s,c=$("<i/>").addClass("config-icon"),u=$("<a />").addClass("config-tile-link").attr("href",l).append(c),d=$("<span />").addClass("tile-name").text(n.draggable.data("tile-name"));r&&a.append(u),a.append(d),i=t.target,$(i).append(a),this.delete_manager(a),this.$le.trigger("modified.layout")};e.droppable({activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:".btn-tile",drop:n.bind(this)});var a=function(t,e){this.$le.trigger("modified.layout")};e.sortable({placeholder:"tile-placeholder",appendTo:".layout",helper:"clone",items:"."+this.tile_class,connectWith:"."+this.column_class,stop:a.bind(this)})}},{key:"tile_events",value:function(t){t||this.$le.find("."+this.tile_class)}},{key:"delete_manager",value:function(t){var e=this.$le,n=$('<button class="close">&times;</button>').css({"font-size":"15px",left:"0","line-height":"15px",overflow:"hidden",position:"absolute","text-align":"center",top:"0",width:"15px"});n.click(function(){$(this).parent("div").remove(),e.trigger("modified.layout")}),n.hover(function(){$(this).parent("div").addClass("to-delete")},function(){$(this).parent("div").removeClass("to-delete")}),t=void 0!==t?t:this.$le.find("."+this.column_class+", ."+this.tile_class+", ."+this.row_class),t.append(n)}},{key:"calculate_grid",value:function(t){var e=t.length,n=Math.floor(this.n_columns/e);e<=this.n_columns&&$(t).attr("data-column-size",n)}},{key:"generate_grid_css",value:function(){s.default.set("."+this.row_class,{width:"98%"}),s.default.set("."+this.row_class+":after",{clear:"both"}),s.default.set("."+this.row_class+":before, ."+this.row_class+":after",{display:"table","line-height":"0",content:'""'}),s.default.set("."+this.column_class,{display:"block",float:"left",width:"100%","min-height":"30px","box-sizing":"border-box"});for(var t="3"*(this.n_columns-1),e=100-t,n=e/this.n_columns,a=1;a<=this.n_columns;a++){var i=n*a,o="3"*(a-1);s.default.set('[data-column-size="'+a+'"]',{width:i+o+"%","margin-left":"3%"})}s.default.set("."+this.column_class+":nth-of-type(1)",{"margin-left":"0"})}},{key:"layout_modified",value:function(){$("#btn-save").hasClass("saved")&&($("#btn-save").find("span").text("Save"),$("#btn-save").removeClass(function(t,e){return(e.match(/\bbtn-\S+/g)||[]).join(" ")}),$("#btn-save").removeClass("saved error"),$("#btn-save").addClass("modified btn-warning"),$("#btn-export").addClass("disabled"))}},{key:"resize_columns_manager",value:function(t){var e=this.$le;t=void 0!==t?t:this.$le.find("."+this.column_class);var n=$("<i/>").addClass("resizer");$(t).append(n),$("#resizer").dialog({autoOpen:!1}),$(".resizer").click(function(){$("#resizer").dialog("open");var t=$(this).parents(".cover-column"),n=t.attr("data-column-size");return $("#column-size-resize span").html(n),$("#slider").slider("option","value",n),$("#slider").off("slide"),$("#slider").on("slide",function(n,a){t.attr("data-column-size",a.value),e.trigger("modified.layout")}),!1}),$("#slider").slider({range:"max",min:1,max:this.n_columns,value:1,slide:function(t,e){$("#column-size-resize span").html(e.value)}}),$("#amount").val($("#slider-range-max").slider("value"))}},{key:"class_chooser_manager",value:function(){$("#class-chooser").dialog({autoOpen:!1}),$(document).on("click",".config-row-link, .config-column-link",function(t){t.preventDefault();var e=$(this).parent(),n=$("#class-chooser > .cssclasswidget");$("#class-chooser > .cssclasswidget-selected").val(e.attr("data-css-class")),new c.default(n,function(t){e.attr("data-css-class",t)}),$("#class-chooser").dialog("open")})}},{key:"tile_config_manager",value:function(){$(document).on("click","#configure_tile #buttons-save",function(t){t.preventDefault();var e=$("#configure_tile").attr("action"),n=$("#configure_tile").serialize();return n+="&buttons.save=Save&ajax_load=true",$.ajax({type:"POST",url:e,data:n,success:function(t,e){$("#tile-configure").html(""),$("#tile-configure").modal("hide")}}),!1}),$(document).on("click","#configure_tile #buttons-cancel",function(t){return t.preventDefault(),$("#tile-configure").html(""),$("#tile-configure").modal("hide"),!1}),$(document).on("click",".config-tile-link",function(t){t.preventDefault();var e=$(this).attr("href");return $("#tile-configure").modal(),$.ajax({type:"GET",url:e,data:{ajax_load:!0},success:function(t){$("#tile-configure").html(t);var e=$("[id$=css_class]").attr("id"),n=$("#configure_tile div.field:first");n.attr("id")!=e&&$("#"+e).insertBefore(n),new c.default($("#"+e+" .cssclasswidget")),$("#configure_tile div.field").not("#"+e).addClass("config-sortable"),$("#configure_tile").sortable({opacity:.6,cursor:"move",placeholder:"ui-state-highlight",zIndex:9999,refreshPositions:!0,axis:"y",tolerance:"pointer",forcePlaceholderSize:!0,items:"div.config-sortable",update:function(t,e){$(this).children("div.field").each(function(){var t=($(this),$(this).index()+1);$(this).children("div.order-box").children("input").val(t-1)})}})}}),!1})}},{key:"html2json",value:function(t){var e=[],n=void 0,a=!0,i=!1,o=void 0;try{for(var r,s=$(t).find("> div").not(".no-export")[Symbol.iterator]();!(a=(r=s.next()).done);a=!0){var l=r.value;if(n=$(l),void 0!==n.not(".row-droppable")[0]){n.removeClass("ui-droppable ui-sortable");var c={},u=new RegExp(/\bcolumn|\brow|\btile/),d=u.exec(n.attr("class"));d&&(c.type=d[0]),"column"==d&&(c.roles=["Manager"],c.type="group",c["column-size"]=n.data("columnSize")),n.attr("data-css-class")&&(c["css-class"]=n.attr("data-css-class"));var h=this.html2json(n);void 0!==h[0]&&(c.children=h);var f=n.attr("data-panel")||n.attr("id");void 0!==f&&(c.id=f);var p=n.attr("data-tile-type");void 0!==p&&(c["tile-type"]=p),e.push(c)}}}catch(t){i=!0,o=t}finally{try{!a&&s.return&&s.return()}finally{if(i)throw o}}return e}}]),t}();e.default=u},function(t,e,n){"use strict";var a=function(){function t(t){for(var e=t.cssRules||t.rules||[],n={},a=0;a<e.length;a++){var i=o(e[a].selectorText);n[i]||(n[i]=[]),n[i].push({sheet:t,index:a,style:e[a].style})}return n}function e(t,e){var n=t.cssRules||t.rules||[],a=[];e=e.toLowerCase();for(var i=0;i<n.length;i++){var o=n[i].selectorText;!o||o!=e&&o!=d(e)&&o!=h(e)||a.push({sheet:t,index:i,style:n[i].style})}return a}function n(t,e){var n=t.cssRules||t.rules||[],o=n.length;return i(t,e,n,o)||a(t,e,o),{sheet:t,index:o,style:n[o].style}}function a(t,e,n){t.insertRule?t.insertRule(e+" { }",n):t.addRule(e,null,n)}function i(t,e,n,i){var s,l;if($.exec(e))s=e,l=r(e);else{if(!b.exec(e))return!1;s=o(e),l=e}return g||(a(t,s,i),n.length<=i&&(g=!0)),g&&a(t,l,i),!0}function o(t){return t.replace(b,function(t,e,n,a){return e+"::"+a})}function r(t){return t.replace($,function(t,e,n){return":"+n})}function s(t){var e=t.sheet;e.deleteRule?e.deleteRule(t.index):e.removeRule&&e.removeRule(t.index)}function l(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function c(t){for(var e={},n=0;n<t.length;n++)l(e,u(t[n].style));return e}function u(t){for(var e={},n=0;n<t.length;n++)e[t[n]]=t[p(t[n])];return e}function d(t){for(var e,n="",a=0;null!=(e=y.exec(t))&&""!==e[0];)n+=t.substring(a,e.index),n+=t.substr(e.index+e[1].length,e[2].length),n+=t.substr(e.index,e[1].length),a=e.index+e[0].length;return n+=t.substr(a)}function h(t){return $.exec(t)?r(t):t}function f(t,e){for(var n in e){var a=e[n],i=a.indexOf(" !important");t.style.removeProperty(n),i>0?t.style.setProperty(n,a.substr(0,i),"important"):t.style.setProperty(n,a)}}function p(t){return t.replace(/-([a-z])/g,function(t,e){return e.toUpperCase()})}function v(t){var e={};for(var n in t)e[m(n)]=t[n];return e}function m(t){return t.replace(/([A-Z])/g,function(t,e){return"-"+e.toLowerCase()})}var g,y=/((?:\.|#)[^\.\s#]+)((?:\.|#)[^\.\s#]+)/g,$=/(::)(before|after|first-line|first-letter|selection)/,b=/([^:])(:)(before|after|first-line|first-letter|selection)/,_=function(t){this.doc=t,this.head=this.doc.head||this.doc.getElementsByTagName("head")[0],this.sheets=this.doc.styleSheets||[]};_.prototype={get:function(n){if(!this.defaultSheet)return{};if(n)return c(e(this.defaultSheet,n));var a=t(this.defaultSheet);for(n in a)a[n]=c(a[n]);return a},getAll:function(t){for(var n={},a=0;a<this.sheets.length;a++)l(n,c(e(this.sheets[a],t)));return n},set:function(t,a){this.defaultSheet||(this.defaultSheet=this._createSheet()),a=v(a);var i=e(this.defaultSheet,t);i.length||(i=[n(this.defaultSheet,t)]);for(var o=0;o<i.length;o++)f(i[o],a)},remove:function(t){if(this.defaultSheet){if(!t)return this._removeSheet(this.defaultSheet),void delete this.defaultSheet;for(var n=e(this.defaultSheet,t),a=0;a<n.length;a++)s(n[a]);return n.length}},_createSheet:function(){var t=this.doc.createElement("style");return t.type="text/css",t.rel="stylesheet",this.head.appendChild(t),t.sheet},_removeSheet:function(t){var e=t.ownerNode;e.parentNode.removeChild(e)}};var x=new _(document);return x.forDocument=function(t){return new _(t)},x}();void 0!==t&&t.exports&&(t.exports=a)},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),o=function(){function t(e,n){a(this,t),this.$el=e,this.callback=n,this.$value=e.next(),this.open=!1;var i=void 0,o=void 0,r=void 0;this.order=[],this.options={};var s=JSON.parse(e.attr("data-options"));for(i=0,r=s.length;i<r;i++)o=s[i],this.order.push(o.value),this.options[o.value]=o;this.setSelected(this.$value.val()),this.update(),this.$el.on("click",this.onButtonClick.bind(this))}return i(t,[{key:"update",value:function(){var t=void 0,e=void 0,n=void 0,a=void 0,i="";for(t=0,a=this.order.length;t<a;t++)e=this.order[t],n=this.options[e],n.selected&&(i+=" "+e);i=i.trim(),""===i&&(i="tile-default"),this.$value.val(i),this.callback instanceof Function&&this.callback(i)}},{key:"setSelected",value:function(t){t=null==t||""===t?[]:t.split(" ");var e=void 0,n=void 0,a=void 0;for(e=0,a=t.length;e<a;e++)"tile-default"!==(n=t[e])&&(this.options[n].selected=!0);this.update()}},{key:"onButtonClick",value:function(t){if(t.preventDefault(),$(".cssclasswidget-overlay").remove(),$(".cssclasswidget-classlist").remove(),this.open=!this.open,this.open){var e=$('<div class="cssclasswidget-overlay">');e.insertAfter(this.$el),e.on("click",this.onOverlayClick.bind(this));var n=$('<ul class="cssclasswidget-classlist">'),a=void 0,i=void 0,o=void 0,r=void 0,s=void 0;for(a=0,s=this.order.length;a<s;a++)i=this.order[a],o=this.options[i],r=$('<li><input name="'+i+'" type="checkbox" value="'+i+'" /><span class="cssclasswidget-'+i+'">'+o.content+"</span></li>"),o.selected&&$("input",r).attr("checked","checked"),n.append(r);n.insertAfter(this.$el),n.offset(this.$el.offset()),n.css("transform","translateY("+(this.$el.height()+4)+"px)"),$("span",n).on("click",this.onItemClick.bind(this))}}},{key:"onOverlayClick",value:function(t){t.preventDefault(),this.open=!1,$(".cssclasswidget-overlay").remove(),$(".cssclasswidget-classlist").remove()}},{key:"onItemClick",value:function(t){t.preventDefault();var e=$(t.target).prev(),n=e.attr("name");e.is(":checked")?e.removeAttr("checked"):e.attr("checked","checked"),this.options[n].selected=e.is(":checked"),this.update()}}]),t}();e.default=o},function(t,e,n){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function t(e){a(this,t),$("#content").on("click",".cover-calendar-tile a.calendar-tile-prev,\n                      .cover-calendar-tile a.calendar-tile-next",function(t){t.preventDefault();var e=$(this),n=e.parents(".tile");$.ajax({url:"@@updatetile",data:{"tile-id":n.attr("id"),"month:int":e.attr("data-month"),"year:int":e.attr("data-year")},success:function(t){return n.html(t),!1},error:function(t,e,a){return n.html(e+": "+a),!1}})})};e.default=i}]).default;