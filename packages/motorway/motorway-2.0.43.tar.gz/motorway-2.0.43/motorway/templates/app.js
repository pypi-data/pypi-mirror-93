!function(e){function t(r){if(a[r])return a[r].exports;var s=a[r]={exports:{},id:r,loaded:!1};return e[r].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var a={};return t.m=e,t.c=a,t.p="",t(0)}([function(e,t,a){e.exports=a(2)},function(e,t){"use strict";var a={getISODuration:function(e){var t=/^P(?:(\d+(?:[\.,]\d{0,3})?W)|(\d+(?:[\.,]\d{0,3})?Y)?(\d+(?:[\.,]\d{0,3})?M)?(\d+(?:[\.,]\d{0,3})?D)?(?:T(\d+(?:[\.,]\d{0,3})?H)?(\d+(?:[\.,]\d{0,3})?M)?(\d+(?:[\.,]\d{0,6})?S)?)?)$/,a=e.match(t);if(null===a)throw'"'+e+'" is an invalid ISO 8601 duration';var r={weeks:parseFloat(a[1],10),years:parseFloat(a[2],10),months:parseFloat(a[3],10),days:parseFloat(a[4],10),hours:parseFloat(a[5],10),minutes:parseFloat(a[6],10),seconds:parseFloat(a[7],10),milliseconds:parseFloat(a[8],10)};return $.each(r,function(e,t){r[e]=t?t:0}),r},getSecondsFromDuration:function(e){var t=0;return t+=365*e.years*24*60*60,t+=30*e.months*24*60*60,t+=7*e.weeks*24*60*60,t+=24*e.days*60*60,t+=60*e.hours*60,t+=60*e.minutes,t+=e.seconds},formatSeconds:function(e){var t="",a=parseInt(e/60/60);a>=1&&(t+=a+"h ",e-=60*a*60);var r=parseInt(e/60);return r>=1&&(t+=r+"m ",e-=60*r),t+=parseInt(e)+"s"},formatISODuration:function(e){var t=0,a=0,r=0,s=0;return e.seconds&&e.seconds<1&&e.seconds>0&&(s+=parseInt(1e3*e.seconds)),e.seconds&&(r+=parseInt(e.seconds)),e.minutes&&(a+=parseFloat(e.minutes)),e.hours&&(t+=parseFloat(e.hours)),e.days&&(t+=24*parseFloat(e.days)),e.weeks&&(t+=24*parseFloat(e.weeks)*7),e.months&&(t+=24*parseFloat(e.months)*7*4),e.years&&(t+=24*parseFloat(e.years)*7*4*12),r=r.toString(),a=a.toString(),t=t.toString(),"0"==t&&"0"==a&&"0"==r?s+"ms":"0"==t&&"0"==a?r+"s":"0"==t?a+"m "+r+"s":t+"h "+a+"m "+r+"s"}};e.exports=a},function(e,t,a){var r=a(3),s=a(1),n=React.createClass({displayName:"Pipeline",getInitialState:function(){return{groups:[]}},componentDidMount:function(){this.loadState()},render:function(){return Object.keys(this.state.groups).length?React.createElement("div",{className:"pipeline"},React.createElement(r,{groups:this.state.groups,lastMinutes:this.state.lastMinutes})):React.createElement("div",{className:"loader"},React.createElement("span",{className:"fa fa-circle-o-notch fa-spin"}),React.createElement("p",null,"Motorway is loading..."))},getNodeData:function(e){var t={name:e[0],histogram:e[1].histogram,avgTime:s.getISODuration(e[1].avg_time_taken),percentile:s.getISODuration(e[1]["95_percentile"]),waiting:e[1].waiting},a=t.name.replace(/([A-Z])/g," $1");a=a.split("-")[0].split(" ");var r=a.splice(a.length-1,1).join(" ").toLowerCase();a=a.join(" "),t.title=a,t.nodeType=r,t.status=e[1].status;var n={ramp:"road",intersection:"exchange",tap:"road",transformer:"exchange"};return t.iconClass="fa fa-"+n[r],t.secondsRemaining=s.getSecondsFromDuration(t.avgTime)*t.waiting,t.url=PipelineSettings.detailUrlPrefix+t.name,t},loadState:function(){var e,t=this;e="/api/status/",$.getJSON(e,function(e){t.isMounted()&&t.setState({groups:e.groups,lastMinutes:e.last_minutes})}).done(function(){$("body").removeClass("disconnected")}).fail(function(){$("body").addClass("disconnected")}).always(function(){var e=$("#pulse");e.show(),setTimeout(function(){e.hide()},100),setTimeout(function(){t.loadState()},1e3)})}});ReactDOM.render(React.createElement(n,null),document.querySelector("#container"))},function(e,t,a){var r=a(4),s=a(1),n=React.createClass({displayName:"GroupContainer",getGroupSize:function(e){console.log(e);var t=.8,a=parseInt(Math.sqrt(e/t)),r=100/a,s=Math.ceil(e/a);return[r,100/s]},render:function(){var e=this,t=e.getGroupSize(Object.keys(e.props.groups).length),a={width:t[0]+"%",height:t[1]+"%"};return React.createElement("div",{className:"groups-container"},$.map(Object.keys(e.props.groups).sort(),function(t){var n=e.props.groups[t],c=t.replace(/([A-Z])/g," $1");c=c.split("-")[0].split(" ");var o=c.splice(c.length-1,1).join(" ").toLowerCase();c=c.join(" ");var i={ramp:"road",intersection:"exchange",tap:"road",transformer:"exchange"}[o],l={ramp:"blue",intersection:"green",tap:"blue",transformer:"green"}[o],u="fa fa-"+i,p="circle-icon circle-icon-"+l,m=s.formatISODuration(s.getISODuration(n.avg_time_taken));return React.createElement("div",{className:"group",key:t,style:a},React.createElement("div",{className:"group-content"},React.createElement("div",{className:"group-content-inner"},React.createElement("h1",null,React.createElement("span",{className:p},React.createElement("i",{className:u})),c),React.createElement("ul",{className:"status-icons"},$.map(Object.keys(n.processes),function(e){var t=n.processes[e],a="";switch(t.state){case"available":a="fa-check-circle";break;case"busy":a="fa-cog fa-spin";break;case"overloaded":a="fa-exclamation-triangle flash"}var r="fa "+a,s="/detail/"+e+"/";return React.createElement("li",{key:e},React.createElement("a",{href:s},React.createElement("span",{className:r,title:e})))})),React.createElement("div",{className:"stats"},React.createElement("div",{className:"col"},React.createElement("span",{className:"label"},"Items in queue"),n.waiting),React.createElement("div",{className:"col"},React.createElement("span",{className:"label"},"Avg/item"),React.createElement("span",{className:"small"},"xÌ„:")," ",m))),React.createElement(r,{histogram:n.histogram,lastMinutes:e.props.lastMinutes})))}))}});e.exports=n},function(e,t){var a=React.createClass({displayName:"NodeGraph",render:function(){var e=this.props.histogram,t=0;$.each(e,function(e,a){t=Math.max(t,a.success_count+a.error_count+a.timeout_count)}),$.each(e,function(a,r){t>0?(e[a].success_percentage=r.success_count/t*100,e[a].error_percentage=r.error_count/t*100,e[a].timeout_percentage=r.timeout_count/t*100):(e[a].success_percentage=0,e[a].error_percentage=0,e[a].timeout_percentage=0)});var a=this.props.lastMinutes.map(function(t){return{minute:t,value:e[t]}});return React.createElement("div",{className:"node-graph"},a.map(function(e){var t={height:parseInt(100-parseInt(e.value.success_percentage)-parseInt(e.value.error_percentage)-parseInt(e.value.timeout_percentage))+"%"},a={height:parseInt(e.value.success_percentage)+"%"},r={height:parseInt(e.value.timeout_percentage)+"%"},s={height:parseInt(e.value.error_percentage)+"%"};return React.createElement("span",{className:"node-graph-bar",key:e.minute},React.createElement("span",{className:"node-graph-bar-part node-graph-blank",style:t}),React.createElement("span",{className:"node-graph-bar-part node-graph-success",style:a},e.value.success_count),React.createElement("span",{className:"node-graph-bar-part node-graph-timeout",style:r},e.value.timeout_count),React.createElement("span",{className:"node-graph-bar-part node-graph-error",style:s},e.value.error_count))}))}});e.exports=a}]);